✓ GPU memory growth enabled for 1 GPUs
Loading dataset...
Loaded 144 images and 144 masks
Training set: (129, 256, 256, 3), Validation set: (15, 256, 256, 3)

============================================================
TRAINING: Attention_ResUNet
Learning Rate: 0.005, Batch Size: 8, Epochs: 30
============================================================
Model: "UNet"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_1 (InputLayer)        [(None, 256, 256, 1)]        0         []                            
                                                                                                  
 conv2d (Conv2D)             (None, 256, 256, 64)         640       ['input_1[0][0]']             
                                                                                                  
 batch_normalization (Batch  (None, 256, 256, 64)         256       ['conv2d[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 activation (Activation)     (None, 256, 256, 64)         0         ['batch_normalization[0][0]'] 
                                                                                                  
 conv2d_1 (Conv2D)           (None, 256, 256, 64)         36928     ['activation[0][0]']          
                                                                                                  
 batch_normalization_1 (Bat  (None, 256, 256, 64)         256       ['conv2d_1[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_1 (Activation)   (None, 256, 256, 64)         0         ['batch_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d (MaxPooling2  (None, 128, 128, 64)         0         ['activation_1[0][0]']        
 D)                                                                                               
                                                                                                  
 conv2d_2 (Conv2D)           (None, 128, 128, 128)        73856     ['max_pooling2d[0][0]']       
                                                                                                  
 batch_normalization_2 (Bat  (None, 128, 128, 128)        512       ['conv2d_2[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_2 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_2[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_3 (Conv2D)           (None, 128, 128, 128)        147584    ['activation_2[0][0]']        
                                                                                                  
 batch_normalization_3 (Bat  (None, 128, 128, 128)        512       ['conv2d_3[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_3 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_3[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_1 (MaxPoolin  (None, 64, 64, 128)          0         ['activation_3[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)           (None, 64, 64, 256)          295168    ['max_pooling2d_1[0][0]']     
                                                                                                  
 batch_normalization_4 (Bat  (None, 64, 64, 256)          1024      ['conv2d_4[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_4 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_4[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_5 (Conv2D)           (None, 64, 64, 256)          590080    ['activation_4[0][0]']        
                                                                                                  
 batch_normalization_5 (Bat  (None, 64, 64, 256)          1024      ['conv2d_5[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_5 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_5[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_2 (MaxPoolin  (None, 32, 32, 256)          0         ['activation_5[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_6 (Conv2D)           (None, 32, 32, 512)          1180160   ['max_pooling2d_2[0][0]']     
                                                                                                  
 batch_normalization_6 (Bat  (None, 32, 32, 512)          2048      ['conv2d_6[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_6 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_6[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_7 (Conv2D)           (None, 32, 32, 512)          2359808   ['activation_6[0][0]']        
                                                                                                  
 batch_normalization_7 (Bat  (None, 32, 32, 512)          2048      ['conv2d_7[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_7 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_7[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_3 (MaxPoolin  (None, 16, 16, 512)          0         ['activation_7[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_8 (Conv2D)           (None, 16, 16, 1024)         4719616   ['max_pooling2d_3[0][0]']     
                                                                                                  
 batch_normalization_8 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_8[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_8 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_8[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_9 (Conv2D)           (None, 16, 16, 1024)         9438208   ['activation_8[0][0]']        
                                                                                                  
 batch_normalization_9 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_9[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_9 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_9[0][0]'
                                                                    ]                             
                                                                                                  
 up_sampling2d (UpSampling2  (None, 32, 32, 1024)         0         ['activation_9[0][0]']        
 D)                                                                                               
                                                                                                  
 concatenate (Concatenate)   (None, 32, 32, 1536)         0         ['up_sampling2d[0][0]',       
                                                                     'activation_7[0][0]']        
                                                                                                  
 conv2d_10 (Conv2D)          (None, 32, 32, 512)          7078400   ['concatenate[0][0]']         
                                                                                                  
 batch_normalization_10 (Ba  (None, 32, 32, 512)          2048      ['conv2d_10[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_10 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_10[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_11 (Conv2D)          (None, 32, 32, 512)          2359808   ['activation_10[0][0]']       
                                                                                                  
 batch_normalization_11 (Ba  (None, 32, 32, 512)          2048      ['conv2d_11[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_11 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_11[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_1 (UpSamplin  (None, 64, 64, 512)          0         ['activation_11[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_1 (Concatenate  (None, 64, 64, 768)          0         ['up_sampling2d_1[0][0]',     
 )                                                                   'activation_5[0][0]']        
                                                                                                  
 conv2d_12 (Conv2D)          (None, 64, 64, 256)          1769728   ['concatenate_1[0][0]']       
                                                                                                  
 batch_normalization_12 (Ba  (None, 64, 64, 256)          1024      ['conv2d_12[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_12 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_12[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_13 (Conv2D)          (None, 64, 64, 256)          590080    ['activation_12[0][0]']       
                                                                                                  
 batch_normalization_13 (Ba  (None, 64, 64, 256)          1024      ['conv2d_13[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_13 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_13[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_2 (UpSamplin  (None, 128, 128, 256)        0         ['activation_13[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_2 (Concatenate  (None, 128, 128, 384)        0         ['up_sampling2d_2[0][0]',     
 )                                                                   'activation_3[0][0]']        
                                                                                                  
 conv2d_14 (Conv2D)          (None, 128, 128, 128)        442496    ['concatenate_2[0][0]']       
                                                                                                  
 batch_normalization_14 (Ba  (None, 128, 128, 128)        512       ['conv2d_14[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_14 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_14[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_15 (Conv2D)          (None, 128, 128, 128)        147584    ['activation_14[0][0]']       
                                                                                                  
 batch_normalization_15 (Ba  (None, 128, 128, 128)        512       ['conv2d_15[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_15 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_15[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_3 (UpSamplin  (None, 256, 256, 128)        0         ['activation_15[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_3 (Concatenate  (None, 256, 256, 192)        0         ['up_sampling2d_3[0][0]',     
 )                                                                   'activation_1[0][0]']        
                                                                                                  
 conv2d_16 (Conv2D)          (None, 256, 256, 64)         110656    ['concatenate_3[0][0]']       
                                                                                                  
 batch_normalization_16 (Ba  (None, 256, 256, 64)         256       ['conv2d_16[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_16 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_16[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_17 (Conv2D)          (None, 256, 256, 64)         36928     ['activation_16[0][0]']       
                                                                                                  
 batch_normalization_17 (Ba  (None, 256, 256, 64)         256       ['conv2d_17[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_17 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_17[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_18 (Conv2D)          (None, 256, 256, 1)          65        ['activation_17[0][0]']       
                                                                                                  
 batch_normalization_18 (Ba  (None, 256, 256, 1)          4         ['conv2d_18[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_18 (Activation)  (None, 256, 256, 1)          0         ['batch_normalization_18[0][0]
                                                                    ']                            
                                                                                                  
==================================================================================================
Total params: 31401349 (119.79 MB)
Trainable params: 31389571 (119.74 MB)
Non-trainable params: 11778 (46.01 KB)
__________________________________________________________________________________________________
WARNING:absl:`lr` is deprecated in TF-Keras optimizer, please use `learning_rate` or use the legacy optimizer, e.g.,tf.keras.optimizers.legacy.Adam.
None
✓ focal_loss imported successfully
Epoch 1/30
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1758881078.386426 1220477 service.cc:145] XLA service 0x14d54e013d70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1758881078.386450 1220477 service.cc:153]   StreamExecutor device (0): NVIDIA A40, Compute Capability 8.6
I0000 00:00:1758881078.523937 1220477 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
 1/17 [>.............................] - ETA: 13:56 - loss: 0.3473 - accuracy: 0.5108 - jacard_coef: 0.1082 2/17 [==>...........................] - ETA: 1:08 - loss: 0.3164 - accuracy: 0.4644 - jacard_coef: 0.0914  3/17 [====>.........................] - ETA: 33s - loss: 0.2903 - accuracy: 0.3591 - jacard_coef: 0.0776  4/17 [======>.......................] - ETA: 21s - loss: 0.2734 - accuracy: 0.3129 - jacard_coef: 0.0789 5/17 [=======>......................] - ETA: 15s - loss: 0.2588 - accuracy: 0.2898 - jacard_coef: 0.0855 6/17 [=========>....................] - ETA: 11s - loss: 0.2483 - accuracy: 0.2756 - jacard_coef: 0.0864 7/17 [===========>..................] - ETA: 9s - loss: 0.2394 - accuracy: 0.2657 - jacard_coef: 0.0847  8/17 [=============>................] - ETA: 7s - loss: 0.2371 - accuracy: 0.2695 - jacard_coef: 0.0821 9/17 [==============>...............] - ETA: 6s - loss: 0.2336 - accuracy: 0.2663 - jacard_coef: 0.078910/17 [================>.............] - ETA: 4s - loss: 0.2297 - accuracy: 0.2568 - jacard_coef: 0.078911/17 [==================>...........] - ETA: 3s - loss: 0.2261 - accuracy: 0.2504 - jacard_coef: 0.082912/17 [====================>.........] - ETA: 3s - loss: 0.2231 - accuracy: 0.2436 - jacard_coef: 0.082413/17 [=====================>........] - ETA: 2s - loss: 0.2203 - accuracy: 0.2398 - jacard_coef: 0.081714/17 [=======================>......] - ETA: 1s - loss: 0.2183 - accuracy: 0.2382 - jacard_coef: 0.083215/17 [=========================>....] - ETA: 1s - loss: 0.2157 - accuracy: 0.2402 - jacard_coef: 0.082916/17 [===========================>..] - ETA: 0s - loss: 0.2138 - accuracy: 0.2409 - jacard_coef: 0.083617/17 [==============================] - ETA: 0s - loss: 0.2135 - accuracy: 0.2416 - jacard_coef: 0.087117/17 [==============================] - 67s 937ms/step - loss: 0.2135 - accuracy: 0.2416 - jacard_coef: 0.0871 - val_loss: 1.1216 - val_accuracy: 0.9304 - val_jacard_coef: 3.4079e-12 - lr: 0.0010
Epoch 2/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1796 - accuracy: 0.3016 - jacard_coef: 0.1012 2/17 [==>...........................] - ETA: 3s - loss: 0.1812 - accuracy: 0.2995 - jacard_coef: 0.1091 3/17 [====>.........................] - ETA: 2s - loss: 0.1814 - accuracy: 0.2919 - jacard_coef: 0.0915 4/17 [======>.......................] - ETA: 2s - loss: 0.1824 - accuracy: 0.2942 - jacard_coef: 0.0895 5/17 [=======>......................] - ETA: 2s - loss: 0.1832 - accuracy: 0.3032 - jacard_coef: 0.0818 6/17 [=========>....................] - ETA: 2s - loss: 0.1827 - accuracy: 0.3236 - jacard_coef: 0.0831 7/17 [===========>..................] - ETA: 2s - loss: 0.1826 - accuracy: 0.3466 - jacard_coef: 0.0826 8/17 [=============>................] - ETA: 1s - loss: 0.1822 - accuracy: 0.3627 - jacard_coef: 0.0830 9/17 [==============>...............] - ETA: 1s - loss: 0.1820 - accuracy: 0.3759 - jacard_coef: 0.084410/17 [================>.............] - ETA: 1s - loss: 0.1816 - accuracy: 0.3850 - jacard_coef: 0.082211/17 [==================>...........] - ETA: 1s - loss: 0.1810 - accuracy: 0.3894 - jacard_coef: 0.083612/17 [====================>.........] - ETA: 1s - loss: 0.1809 - accuracy: 0.3985 - jacard_coef: 0.082413/17 [=====================>........] - ETA: 0s - loss: 0.1805 - accuracy: 0.4114 - jacard_coef: 0.081114/17 [=======================>......] - ETA: 0s - loss: 0.1800 - accuracy: 0.4222 - jacard_coef: 0.080115/17 [=========================>....] - ETA: 0s - loss: 0.1795 - accuracy: 0.4330 - jacard_coef: 0.079916/17 [===========================>..] - ETA: 0s - loss: 0.1791 - accuracy: 0.4368 - jacard_coef: 0.080117/17 [==============================] - 3s 205ms/step - loss: 0.1795 - accuracy: 0.4357 - jacard_coef: 0.0756 - val_loss: 1.1107 - val_accuracy: 0.9302 - val_jacard_coef: 3.3968e-12 - lr: 0.0010
Epoch 3/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1865 - accuracy: 0.2611 - jacard_coef: 0.0689 2/17 [==>...........................] - ETA: 3s - loss: 0.1826 - accuracy: 0.3492 - jacard_coef: 0.0822 3/17 [====>.........................] - ETA: 2s - loss: 0.1814 - accuracy: 0.3989 - jacard_coef: 0.0846 4/17 [======>.......................] - ETA: 2s - loss: 0.1805 - accuracy: 0.4366 - jacard_coef: 0.0856 5/17 [=======>......................] - ETA: 2s - loss: 0.1800 - accuracy: 0.4590 - jacard_coef: 0.0783 6/17 [=========>....................] - ETA: 2s - loss: 0.1798 - accuracy: 0.4662 - jacard_coef: 0.0772 7/17 [===========>..................] - ETA: 2s - loss: 0.1794 - accuracy: 0.4667 - jacard_coef: 0.0791 8/17 [=============>................] - ETA: 1s - loss: 0.1791 - accuracy: 0.4580 - jacard_coef: 0.0806 9/17 [==============>...............] - ETA: 1s - loss: 0.1797 - accuracy: 0.4520 - jacard_coef: 0.086710/17 [================>.............] - ETA: 1s - loss: 0.1797 - accuracy: 0.4471 - jacard_coef: 0.086211/17 [==================>...........] - ETA: 1s - loss: 0.1794 - accuracy: 0.4440 - jacard_coef: 0.084612/17 [====================>.........] - ETA: 1s - loss: 0.1793 - accuracy: 0.4456 - jacard_coef: 0.084313/17 [=====================>........] - ETA: 0s - loss: 0.1787 - accuracy: 0.4550 - jacard_coef: 0.084414/17 [=======================>......] - ETA: 0s - loss: 0.1781 - accuracy: 0.4687 - jacard_coef: 0.084415/17 [=========================>....] - ETA: 0s - loss: 0.1778 - accuracy: 0.4761 - jacard_coef: 0.082716/17 [===========================>..] - ETA: 0s - loss: 0.1773 - accuracy: 0.4848 - jacard_coef: 0.080017/17 [==============================] - 4s 209ms/step - loss: 0.1772 - accuracy: 0.4857 - jacard_coef: 0.0783 - val_loss: 0.7900 - val_accuracy: 0.9260 - val_jacard_coef: 0.0018 - lr: 0.0010
Epoch 4/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1788 - accuracy: 0.3775 - jacard_coef: 0.0824 2/17 [==>...........................] - ETA: 3s - loss: 0.1738 - accuracy: 0.5043 - jacard_coef: 0.0849 3/17 [====>.........................] - ETA: 2s - loss: 0.1732 - accuracy: 0.5640 - jacard_coef: 0.0835 4/17 [======>.......................] - ETA: 2s - loss: 0.1721 - accuracy: 0.5839 - jacard_coef: 0.0770 5/17 [=======>......................] - ETA: 2s - loss: 0.1716 - accuracy: 0.5885 - jacard_coef: 0.0672 6/17 [=========>....................] - ETA: 2s - loss: 0.1711 - accuracy: 0.5918 - jacard_coef: 0.0727 7/17 [===========>..................] - ETA: 2s - loss: 0.1707 - accuracy: 0.5928 - jacard_coef: 0.0715 8/17 [=============>................] - ETA: 1s - loss: 0.1703 - accuracy: 0.6058 - jacard_coef: 0.0730 9/17 [==============>...............] - ETA: 1s - loss: 0.1700 - accuracy: 0.6115 - jacard_coef: 0.073210/17 [================>.............] - ETA: 1s - loss: 0.1696 - accuracy: 0.6141 - jacard_coef: 0.075011/17 [==================>...........] - ETA: 1s - loss: 0.1693 - accuracy: 0.6179 - jacard_coef: 0.077212/17 [====================>.........] - ETA: 1s - loss: 0.1692 - accuracy: 0.6180 - jacard_coef: 0.074613/17 [=====================>........] - ETA: 0s - loss: 0.1690 - accuracy: 0.6224 - jacard_coef: 0.074614/17 [=======================>......] - ETA: 0s - loss: 0.1687 - accuracy: 0.6350 - jacard_coef: 0.074515/17 [=========================>....] - ETA: 0s - loss: 0.1684 - accuracy: 0.6474 - jacard_coef: 0.073616/17 [===========================>..] - ETA: 0s - loss: 0.1681 - accuracy: 0.6489 - jacard_coef: 0.072917/17 [==============================] - 4s 208ms/step - loss: 0.1681 - accuracy: 0.6475 - jacard_coef: 0.0732 - val_loss: 0.1308 - val_accuracy: 0.8974 - val_jacard_coef: 0.0121 - lr: 0.0010
Epoch 5/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1619 - accuracy: 0.7270 - jacard_coef: 0.0650 2/17 [==>...........................] - ETA: 3s - loss: 0.1621 - accuracy: 0.7592 - jacard_coef: 0.0551 3/17 [====>.........................] - ETA: 2s - loss: 0.1641 - accuracy: 0.6863 - jacard_coef: 0.0621 4/17 [======>.......................] - ETA: 2s - loss: 0.1638 - accuracy: 0.7091 - jacard_coef: 0.0625 5/17 [=======>......................] - ETA: 2s - loss: 0.1631 - accuracy: 0.7299 - jacard_coef: 0.0529 6/17 [=========>....................] - ETA: 2s - loss: 0.1629 - accuracy: 0.7392 - jacard_coef: 0.0574 7/17 [===========>..................] - ETA: 2s - loss: 0.1627 - accuracy: 0.7545 - jacard_coef: 0.0553 8/17 [=============>................] - ETA: 1s - loss: 0.1626 - accuracy: 0.7620 - jacard_coef: 0.0555 9/17 [==============>...............] - ETA: 1s - loss: 0.1624 - accuracy: 0.7744 - jacard_coef: 0.052110/17 [================>.............] - ETA: 1s - loss: 0.1621 - accuracy: 0.7874 - jacard_coef: 0.049911/17 [==================>...........] - ETA: 1s - loss: 0.1618 - accuracy: 0.7998 - jacard_coef: 0.047012/17 [====================>.........] - ETA: 1s - loss: 0.1622 - accuracy: 0.7840 - jacard_coef: 0.053213/17 [=====================>........] - ETA: 0s - loss: 0.1620 - accuracy: 0.7929 - jacard_coef: 0.050014/17 [=======================>......] - ETA: 0s - loss: 0.1619 - accuracy: 0.7988 - jacard_coef: 0.047415/17 [=========================>....] - ETA: 0s - loss: 0.1618 - accuracy: 0.8066 - jacard_coef: 0.045816/17 [===========================>..] - ETA: 0s - loss: 0.1616 - accuracy: 0.8134 - jacard_coef: 0.043717/17 [==============================] - 4s 208ms/step - loss: 0.1616 - accuracy: 0.8139 - jacard_coef: 0.0421 - val_loss: 0.1670 - val_accuracy: 0.4744 - val_jacard_coef: 0.0800 - lr: 0.0010
Epoch 6/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1604 - accuracy: 0.8906 - jacard_coef: 0.0237 2/17 [==>...........................] - ETA: 3s - loss: 0.1598 - accuracy: 0.8910 - jacard_coef: 0.0165 3/17 [====>.........................] - ETA: 2s - loss: 0.1596 - accuracy: 0.8931 - jacard_coef: 0.0248 4/17 [======>.......................] - ETA: 2s - loss: 0.1594 - accuracy: 0.8950 - jacard_coef: 0.0333 5/17 [=======>......................] - ETA: 2s - loss: 0.1591 - accuracy: 0.8946 - jacard_coef: 0.0426 6/17 [=========>....................] - ETA: 2s - loss: 0.1590 - accuracy: 0.8880 - jacard_coef: 0.0427 7/17 [===========>..................] - ETA: 2s - loss: 0.1586 - accuracy: 0.8785 - jacard_coef: 0.0458 8/17 [=============>................] - ETA: 1s - loss: 0.1585 - accuracy: 0.8705 - jacard_coef: 0.0476 9/17 [==============>...............] - ETA: 1s - loss: 0.1584 - accuracy: 0.8638 - jacard_coef: 0.048610/17 [================>.............] - ETA: 1s - loss: 0.1583 - accuracy: 0.8592 - jacard_coef: 0.051211/17 [==================>...........] - ETA: 1s - loss: 0.1582 - accuracy: 0.8584 - jacard_coef: 0.050212/17 [====================>.........] - ETA: 1s - loss: 0.1581 - accuracy: 0.8600 - jacard_coef: 0.054113/17 [=====================>........] - ETA: 0s - loss: 0.1579 - accuracy: 0.8594 - jacard_coef: 0.052714/17 [=======================>......] - ETA: 0s - loss: 0.1585 - accuracy: 0.8449 - jacard_coef: 0.051915/17 [=========================>....] - ETA: 0s - loss: 0.1585 - accuracy: 0.8482 - jacard_coef: 0.048816/17 [===========================>..] - ETA: 0s - loss: 0.1586 - accuracy: 0.8420 - jacard_coef: 0.048217/17 [==============================] - 3s 205ms/step - loss: 0.1587 - accuracy: 0.8396 - jacard_coef: 0.0499 - val_loss: 0.2043 - val_accuracy: 0.1395 - val_jacard_coef: 0.0680 - lr: 0.0010
Epoch 7/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1687 - accuracy: 0.5143 - jacard_coef: 0.0629 2/17 [==>...........................] - ETA: 3s - loss: 0.1667 - accuracy: 0.5048 - jacard_coef: 0.0626 3/17 [====>.........................] - ETA: 2s - loss: 0.1663 - accuracy: 0.5081 - jacard_coef: 0.0623 4/17 [======>.......................] - ETA: 2s - loss: 0.1667 - accuracy: 0.5125 - jacard_coef: 0.0717 5/17 [=======>......................] - ETA: 2s - loss: 0.1657 - accuracy: 0.5360 - jacard_coef: 0.0672 6/17 [=========>....................] - ETA: 2s - loss: 0.1650 - accuracy: 0.5757 - jacard_coef: 0.0627 7/17 [===========>..................] - ETA: 2s - loss: 0.1643 - accuracy: 0.6251 - jacard_coef: 0.0542 8/17 [=============>................] - ETA: 1s - loss: 0.1642 - accuracy: 0.6603 - jacard_coef: 0.0484 9/17 [==============>...............] - ETA: 1s - loss: 0.1634 - accuracy: 0.6891 - jacard_coef: 0.043410/17 [================>.............] - ETA: 1s - loss: 0.1629 - accuracy: 0.7079 - jacard_coef: 0.041011/17 [==================>...........] - ETA: 1s - loss: 0.1625 - accuracy: 0.7231 - jacard_coef: 0.039712/17 [====================>.........] - ETA: 1s - loss: 0.1620 - accuracy: 0.7369 - jacard_coef: 0.039313/17 [=====================>........] - ETA: 0s - loss: 0.1616 - accuracy: 0.7491 - jacard_coef: 0.037514/17 [=======================>......] - ETA: 0s - loss: 0.1612 - accuracy: 0.7591 - jacard_coef: 0.034915/17 [=========================>....] - ETA: 0s - loss: 0.1610 - accuracy: 0.7682 - jacard_coef: 0.032716/17 [===========================>..] - ETA: 0s - loss: 0.1606 - accuracy: 0.7781 - jacard_coef: 0.030617/17 [==============================] - 3s 205ms/step - loss: 0.1606 - accuracy: 0.7795 - jacard_coef: 0.0288 - val_loss: 0.0843 - val_accuracy: 0.9241 - val_jacard_coef: 0.0054 - lr: 0.0010
Epoch 8/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1535 - accuracy: 0.9146 - jacard_coef: 2.2322e-12 2/17 [==>...........................] - ETA: 3s - loss: 0.1543 - accuracy: 0.8967 - jacard_coef: 1.9038e-12 3/17 [====>.........................] - ETA: 2s - loss: 0.1536 - accuracy: 0.9102 - jacard_coef: 2.2786e-12 4/17 [======>.......................] - ETA: 2s - loss: 0.1531 - accuracy: 0.9115 - jacard_coef: 2.2743e-12 5/17 [=======>......................] - ETA: 2s - loss: 0.1530 - accuracy: 0.9130 - jacard_coef: 4.7079e-05 6/17 [=========>....................] - ETA: 2s - loss: 0.1529 - accuracy: 0.9186 - jacard_coef: 0.0017     7/17 [===========>..................] - ETA: 2s - loss: 0.1525 - accuracy: 0.9224 - jacard_coef: 0.0015 8/17 [=============>................] - ETA: 1s - loss: 0.1519 - accuracy: 0.9263 - jacard_coef: 0.0013 9/17 [==============>...............] - ETA: 1s - loss: 0.1518 - accuracy: 0.9217 - jacard_coef: 0.001210/17 [================>.............] - ETA: 1s - loss: 0.1518 - accuracy: 0.9188 - jacard_coef: 0.002011/17 [==================>...........] - ETA: 1s - loss: 0.1517 - accuracy: 0.9164 - jacard_coef: 0.002012/17 [====================>.........] - ETA: 1s - loss: 0.1517 - accuracy: 0.9128 - jacard_coef: 0.001813/17 [=====================>........] - ETA: 0s - loss: 0.1515 - accuracy: 0.9144 - jacard_coef: 0.001714/17 [=======================>......] - ETA: 0s - loss: 0.1514 - accuracy: 0.9135 - jacard_coef: 0.001615/17 [=========================>....] - ETA: 0s - loss: 0.1511 - accuracy: 0.9142 - jacard_coef: 0.001516/17 [===========================>..] - ETA: 0s - loss: 0.1509 - accuracy: 0.9163 - jacard_coef: 0.001417/17 [==============================] - 3s 205ms/step - loss: 0.1510 - accuracy: 0.9147 - jacard_coef: 0.0117 - val_loss: 0.1328 - val_accuracy: 0.9235 - val_jacard_coef: 0.0064 - lr: 0.0010
Epoch 9/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1470 - accuracy: 0.9521 - jacard_coef: 3.9815e-12 2/17 [==>...........................] - ETA: 3s - loss: 0.1499 - accuracy: 0.9245 - jacard_coef: 3.0515e-04 3/17 [====>.........................] - ETA: 2s - loss: 0.1499 - accuracy: 0.9273 - jacard_coef: 2.0344e-04 4/17 [======>.......................] - ETA: 2s - loss: 0.1505 - accuracy: 0.9158 - jacard_coef: 1.6060e-04 5/17 [=======>......................] - ETA: 2s - loss: 0.1516 - accuracy: 0.9138 - jacard_coef: 3.3916e-04 6/17 [=========>....................] - ETA: 2s - loss: 0.1513 - accuracy: 0.9209 - jacard_coef: 2.8263e-04 7/17 [===========>..................] - ETA: 2s - loss: 0.1514 - accuracy: 0.9197 - jacard_coef: 2.7033e-04 8/17 [=============>................] - ETA: 1s - loss: 0.1517 - accuracy: 0.9162 - jacard_coef: 3.5979e-04 9/17 [==============>...............] - ETA: 1s - loss: 0.1520 - accuracy: 0.9178 - jacard_coef: 6.7380e-0410/17 [================>.............] - ETA: 1s - loss: 0.1517 - accuracy: 0.9209 - jacard_coef: 6.0642e-0411/17 [==================>...........] - ETA: 1s - loss: 0.1515 - accuracy: 0.9205 - jacard_coef: 5.5129e-0412/17 [====================>.........] - ETA: 1s - loss: 0.1512 - accuracy: 0.9212 - jacard_coef: 5.0535e-0413/17 [=====================>........] - ETA: 0s - loss: 0.1512 - accuracy: 0.9174 - jacard_coef: 4.6647e-0414/17 [=======================>......] - ETA: 0s - loss: 0.1511 - accuracy: 0.9154 - jacard_coef: 4.3316e-0415/17 [=========================>....] - ETA: 0s - loss: 0.1508 - accuracy: 0.9166 - jacard_coef: 4.0428e-0416/17 [===========================>..] - ETA: 0s - loss: 0.1506 - accuracy: 0.9165 - jacard_coef: 3.7901e-0417/17 [==============================] - 3s 205ms/step - loss: 0.1506 - accuracy: 0.9160 - jacard_coef: 3.5672e-04 - val_loss: 0.1393 - val_accuracy: 0.9267 - val_jacard_coef: 0.0067 - lr: 0.0010
Epoch 10/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1474 - accuracy: 0.9125 - jacard_coef: 0.0252 2/17 [==>...........................] - ETA: 3s - loss: 0.1466 - accuracy: 0.8926 - jacard_coef: 0.0448 3/17 [====>.........................] - ETA: 2s - loss: 0.1463 - accuracy: 0.8758 - jacard_coef: 0.0425 4/17 [======>.......................] - ETA: 2s - loss: 0.1468 - accuracy: 0.8724 - jacard_coef: 0.0439 5/17 [=======>......................] - ETA: 2s - loss: 0.1465 - accuracy: 0.8776 - jacard_coef: 0.0366 6/17 [=========>....................] - ETA: 2s - loss: 0.1457 - accuracy: 0.8816 - jacard_coef: 0.0640 7/17 [===========>..................] - ETA: 2s - loss: 0.1456 - accuracy: 0.8747 - jacard_coef: 0.0701 8/17 [=============>................] - ETA: 1s - loss: 0.1454 - accuracy: 0.8804 - jacard_coef: 0.0615 9/17 [==============>...............] - ETA: 1s - loss: 0.1458 - accuracy: 0.8818 - jacard_coef: 0.054810/17 [================>.............] - ETA: 1s - loss: 0.1457 - accuracy: 0.8852 - jacard_coef: 0.049611/17 [==================>...........] - ETA: 1s - loss: 0.1454 - accuracy: 0.8895 - jacard_coef: 0.045012/17 [====================>.........] - ETA: 1s - loss: 0.1453 - accuracy: 0.8902 - jacard_coef: 0.041613/17 [=====================>........] - ETA: 0s - loss: 0.1454 - accuracy: 0.8892 - jacard_coef: 0.039414/17 [=======================>......] - ETA: 0s - loss: 0.1451 - accuracy: 0.8933 - jacard_coef: 0.036615/17 [=========================>....] - ETA: 0s - loss: 0.1451 - accuracy: 0.8934 - jacard_coef: 0.034316/17 [===========================>..] - ETA: 0s - loss: 0.1450 - accuracy: 0.8949 - jacard_coef: 0.032117/17 [==============================] - 3s 205ms/step - loss: 0.1452 - accuracy: 0.8928 - jacard_coef: 0.0306 - val_loss: 0.1577 - val_accuracy: 0.9289 - val_jacard_coef: 0.0031 - lr: 0.0010
Epoch 11/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1425 - accuracy: 0.9300 - jacard_coef: 0.0010 2/17 [==>...........................] - ETA: 3s - loss: 0.1425 - accuracy: 0.9326 - jacard_coef: 5.0339e-04 3/17 [====>.........................] - ETA: 2s - loss: 0.1433 - accuracy: 0.9208 - jacard_coef: 3.3559e-04 4/17 [======>.......................] - ETA: 2s - loss: 0.1445 - accuracy: 0.9103 - jacard_coef: 8.2040e-04 5/17 [=======>......................] - ETA: 2s - loss: 0.1453 - accuracy: 0.9021 - jacard_coef: 0.0011     6/17 [=========>....................] - ETA: 2s - loss: 0.1448 - accuracy: 0.9083 - jacard_coef: 0.0012 7/17 [===========>..................] - ETA: 2s - loss: 0.1450 - accuracy: 0.9052 - jacard_coef: 0.0010 8/17 [=============>................] - ETA: 1s - loss: 0.1451 - accuracy: 0.9038 - jacard_coef: 9.3373e-04 9/17 [==============>...............] - ETA: 1s - loss: 0.1449 - accuracy: 0.9070 - jacard_coef: 8.2999e-0410/17 [================>.............] - ETA: 1s - loss: 0.1446 - accuracy: 0.9101 - jacard_coef: 7.4699e-0411/17 [==================>...........] - ETA: 1s - loss: 0.1448 - accuracy: 0.9102 - jacard_coef: 7.7101e-0412/17 [====================>.........] - ETA: 1s - loss: 0.1448 - accuracy: 0.9102 - jacard_coef: 7.3162e-0413/17 [=====================>........] - ETA: 0s - loss: 0.1447 - accuracy: 0.9109 - jacard_coef: 6.7534e-0414/17 [=======================>......] - ETA: 0s - loss: 0.1445 - accuracy: 0.9133 - jacard_coef: 6.2710e-0415/17 [=========================>....] - ETA: 0s - loss: 0.1447 - accuracy: 0.9167 - jacard_coef: 7.7713e-0416/17 [===========================>..] - ETA: 0s - loss: 0.1447 - accuracy: 0.9161 - jacard_coef: 7.2856e-0417/17 [==============================] - 3s 205ms/step - loss: 0.1447 - accuracy: 0.9154 - jacard_coef: 6.8570e-04 - val_loss: 0.1430 - val_accuracy: 0.9283 - val_jacard_coef: 0.0021 - lr: 5.0000e-04
Epoch 12/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1428 - accuracy: 0.9203 - jacard_coef: 2.3943e-12 2/17 [==>...........................] - ETA: 3s - loss: 0.1430 - accuracy: 0.9152 - jacard_coef: 5.2998e-05 3/17 [====>.........................] - ETA: 2s - loss: 0.1423 - accuracy: 0.9231 - jacard_coef: 3.5332e-05 4/17 [======>.......................] - ETA: 2s - loss: 0.1424 - accuracy: 0.9230 - jacard_coef: 2.6499e-05 5/17 [=======>......................] - ETA: 2s - loss: 0.1419 - accuracy: 0.9243 - jacard_coef: 2.1199e-05 6/17 [=========>....................] - ETA: 2s - loss: 0.1423 - accuracy: 0.9187 - jacard_coef: 1.7666e-05 7/17 [===========>..................] - ETA: 2s - loss: 0.1425 - accuracy: 0.9163 - jacard_coef: 1.5142e-05 8/17 [=============>................] - ETA: 1s - loss: 0.1421 - accuracy: 0.9206 - jacard_coef: 4.7524e-05 9/17 [==============>...............] - ETA: 1s - loss: 0.1420 - accuracy: 0.9208 - jacard_coef: 4.4954e-0510/17 [================>.............] - ETA: 1s - loss: 0.1418 - accuracy: 0.9214 - jacard_coef: 5.0899e-0511/17 [==================>...........] - ETA: 1s - loss: 0.1420 - accuracy: 0.9187 - jacard_coef: 4.6271e-0512/17 [====================>.........] - ETA: 1s - loss: 0.1422 - accuracy: 0.9151 - jacard_coef: 4.2415e-0513/17 [=====================>........] - ETA: 0s - loss: 0.1420 - accuracy: 0.9164 - jacard_coef: 3.9153e-0514/17 [=======================>......] - ETA: 0s - loss: 0.1420 - accuracy: 0.9176 - jacard_coef: 1.2082e-0415/17 [=========================>....] - ETA: 0s - loss: 0.1418 - accuracy: 0.9180 - jacard_coef: 1.1276e-0416/17 [===========================>..] - ETA: 0s - loss: 0.1423 - accuracy: 0.9160 - jacard_coef: 5.2316e-0417/17 [==============================] - 3s 205ms/step - loss: 0.1422 - accuracy: 0.9166 - jacard_coef: 4.9239e-04 - val_loss: 0.1291 - val_accuracy: 0.9303 - val_jacard_coef: 3.3999e-12 - lr: 5.0000e-04
Epoch 13/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1450 - accuracy: 0.8695 - jacard_coef: 2.9217e-04 2/17 [==>...........................] - ETA: 3s - loss: 0.1436 - accuracy: 0.8946 - jacard_coef: 0.0042     3/17 [====>.........................] - ETA: 2s - loss: 0.1417 - accuracy: 0.9083 - jacard_coef: 0.0043 4/17 [======>.......................] - ETA: 2s - loss: 0.1416 - accuracy: 0.9034 - jacard_coef: 0.0032 5/17 [=======>......................] - ETA: 2s - loss: 0.1410 - accuracy: 0.9082 - jacard_coef: 0.0027 6/17 [=========>....................] - ETA: 2s - loss: 0.1406 - accuracy: 0.9120 - jacard_coef: 0.0023 7/17 [===========>..................] - ETA: 2s - loss: 0.1399 - accuracy: 0.9150 - jacard_coef: 0.0020 8/17 [=============>................] - ETA: 1s - loss: 0.1398 - accuracy: 0.9172 - jacard_coef: 0.0017 9/17 [==============>...............] - ETA: 1s - loss: 0.1399 - accuracy: 0.9155 - jacard_coef: 0.001510/17 [================>.............] - ETA: 1s - loss: 0.1398 - accuracy: 0.9149 - jacard_coef: 0.001611/17 [==================>...........] - ETA: 1s - loss: 0.1396 - accuracy: 0.9163 - jacard_coef: 0.001512/17 [====================>.........] - ETA: 1s - loss: 0.1395 - accuracy: 0.9160 - jacard_coef: 0.003513/17 [=====================>........] - ETA: 0s - loss: 0.1392 - accuracy: 0.9170 - jacard_coef: 0.004414/17 [=======================>......] - ETA: 0s - loss: 0.1393 - accuracy: 0.9157 - jacard_coef: 0.004315/17 [=========================>....] - ETA: 0s - loss: 0.1392 - accuracy: 0.9160 - jacard_coef: 0.004016/17 [===========================>..] - ETA: 0s - loss: 0.1391 - accuracy: 0.9156 - jacard_coef: 0.003817/17 [==============================] - 3s 205ms/step - loss: 0.1391 - accuracy: 0.9150 - jacard_coef: 0.0035 - val_loss: 0.1338 - val_accuracy: 0.9304 - val_jacard_coef: 3.4110e-12 - lr: 5.0000e-04
Epoch 14/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1374 - accuracy: 0.9212 - jacard_coef: 2.4208e-05 2/17 [==>...........................] - ETA: 3s - loss: 0.1362 - accuracy: 0.9295 - jacard_coef: 1.2104e-05 3/17 [====>.........................] - ETA: 2s - loss: 0.1368 - accuracy: 0.9189 - jacard_coef: 3.1272e-04 4/17 [======>.......................] - ETA: 2s - loss: 0.1372 - accuracy: 0.9178 - jacard_coef: 5.2941e-04 5/17 [=======>......................] - ETA: 2s - loss: 0.1373 - accuracy: 0.9170 - jacard_coef: 4.2352e-04 6/17 [=========>....................] - ETA: 2s - loss: 0.1373 - accuracy: 0.9169 - jacard_coef: 3.7194e-04 7/17 [===========>..................] - ETA: 2s - loss: 0.1372 - accuracy: 0.9186 - jacard_coef: 5.0109e-04 8/17 [=============>................] - ETA: 1s - loss: 0.1372 - accuracy: 0.9166 - jacard_coef: 4.3846e-04 9/17 [==============>...............] - ETA: 1s - loss: 0.1371 - accuracy: 0.9186 - jacard_coef: 3.8974e-0410/17 [================>.............] - ETA: 1s - loss: 0.1371 - accuracy: 0.9179 - jacard_coef: 4.4362e-0411/17 [==================>...........] - ETA: 1s - loss: 0.1370 - accuracy: 0.9188 - jacard_coef: 4.6827e-0412/17 [====================>.........] - ETA: 1s - loss: 0.1371 - accuracy: 0.9175 - jacard_coef: 4.2925e-0413/17 [=====================>........] - ETA: 0s - loss: 0.1369 - accuracy: 0.9185 - jacard_coef: 3.9623e-0414/17 [=======================>......] - ETA: 0s - loss: 0.1368 - accuracy: 0.9197 - jacard_coef: 4.8809e-0415/17 [=========================>....] - ETA: 0s - loss: 0.1370 - accuracy: 0.9175 - jacard_coef: 4.5555e-0416/17 [===========================>..] - ETA: 0s - loss: 0.1371 - accuracy: 0.9163 - jacard_coef: 4.2708e-0417/17 [==============================] - 3s 205ms/step - loss: 0.1371 - accuracy: 0.9161 - jacard_coef: 0.0076 - val_loss: 0.1335 - val_accuracy: 0.9304 - val_jacard_coef: 3.4110e-12 - lr: 5.0000e-04
Epoch 15/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1365 - accuracy: 0.9162 - jacard_coef: 2.2764e-12 2/17 [==>...........................] - ETA: 3s - loss: 0.1351 - accuracy: 0.9225 - jacard_coef: 2.4786e-12 3/17 [====>.........................] - ETA: 2s - loss: 0.1360 - accuracy: 0.9127 - jacard_coef: 2.2463e-12 4/17 [======>.......................] - ETA: 2s - loss: 0.1360 - accuracy: 0.9146 - jacard_coef: 2.2844e-12 5/17 [=======>......................] - ETA: 2s - loss: 0.1356 - accuracy: 0.9175 - jacard_coef: 5.3606e-06 6/17 [=========>....................] - ETA: 2s - loss: 0.1359 - accuracy: 0.9123 - jacard_coef: 0.0014     7/17 [===========>..................] - ETA: 2s - loss: 0.1365 - accuracy: 0.9052 - jacard_coef: 0.0012 8/17 [=============>................] - ETA: 1s - loss: 0.1363 - accuracy: 0.9085 - jacard_coef: 0.0017 9/17 [==============>...............] - ETA: 1s - loss: 0.1368 - accuracy: 0.9035 - jacard_coef: 0.001710/17 [================>.............] - ETA: 1s - loss: 0.1369 - accuracy: 0.9015 - jacard_coef: 0.001511/17 [==================>...........] - ETA: 1s - loss: 0.1368 - accuracy: 0.9022 - jacard_coef: 0.001412/17 [====================>.........] - ETA: 1s - loss: 0.1363 - accuracy: 0.9075 - jacard_coef: 0.001213/17 [=====================>........] - ETA: 0s - loss: 0.1361 - accuracy: 0.9089 - jacard_coef: 0.001214/17 [=======================>......] - ETA: 0s - loss: 0.1357 - accuracy: 0.9132 - jacard_coef: 0.001115/17 [=========================>....] - ETA: 0s - loss: 0.1355 - accuracy: 0.9139 - jacard_coef: 9.9850e-0416/17 [===========================>..] - ETA: 0s - loss: 0.1355 - accuracy: 0.9137 - jacard_coef: 9.3609e-0417/17 [==============================] - 3s 205ms/step - loss: 0.1355 - accuracy: 0.9135 - jacard_coef: 0.0018 - val_loss: 0.1265 - val_accuracy: 0.9304 - val_jacard_coef: 3.4110e-12 - lr: 5.0000e-04
/usr/local/lib/python3.10/dist-packages/tf_keras/src/engine/training.py:3098: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native TF-Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(

✓ Training completed successfully!
  Best Val Jaccard: 0.0800 (epoch 5)
  Final Val Loss: 0.1265
  Training Time: 0:01:56.832695
  Stability (std): 0.0282

Results saved to: hyperparameter_optimization_20250926_165036/exp_34_Attention_ResUNet_lr5e-3_bs8/Attention_ResUNet_lr0.005_bs8_results.json
