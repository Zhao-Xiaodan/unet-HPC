✓ GPU memory growth enabled for 1 GPUs
Loading dataset...
Loaded 144 images and 144 masks
Training set: (129, 256, 256, 3), Validation set: (15, 256, 256, 3)

============================================================
TRAINING: Attention_UNet
Learning Rate: 0.001, Batch Size: 16, Epochs: 30
============================================================
Model: "UNet"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_1 (InputLayer)        [(None, 256, 256, 1)]        0         []                            
                                                                                                  
 conv2d (Conv2D)             (None, 256, 256, 64)         640       ['input_1[0][0]']             
                                                                                                  
 batch_normalization (Batch  (None, 256, 256, 64)         256       ['conv2d[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 activation (Activation)     (None, 256, 256, 64)         0         ['batch_normalization[0][0]'] 
                                                                                                  
 conv2d_1 (Conv2D)           (None, 256, 256, 64)         36928     ['activation[0][0]']          
                                                                                                  
 batch_normalization_1 (Bat  (None, 256, 256, 64)         256       ['conv2d_1[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_1 (Activation)   (None, 256, 256, 64)         0         ['batch_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d (MaxPooling2  (None, 128, 128, 64)         0         ['activation_1[0][0]']        
 D)                                                                                               
                                                                                                  
 conv2d_2 (Conv2D)           (None, 128, 128, 128)        73856     ['max_pooling2d[0][0]']       
                                                                                                  
 batch_normalization_2 (Bat  (None, 128, 128, 128)        512       ['conv2d_2[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_2 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_2[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_3 (Conv2D)           (None, 128, 128, 128)        147584    ['activation_2[0][0]']        
                                                                                                  
 batch_normalization_3 (Bat  (None, 128, 128, 128)        512       ['conv2d_3[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_3 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_3[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_1 (MaxPoolin  (None, 64, 64, 128)          0         ['activation_3[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)           (None, 64, 64, 256)          295168    ['max_pooling2d_1[0][0]']     
                                                                                                  
 batch_normalization_4 (Bat  (None, 64, 64, 256)          1024      ['conv2d_4[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_4 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_4[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_5 (Conv2D)           (None, 64, 64, 256)          590080    ['activation_4[0][0]']        
                                                                                                  
 batch_normalization_5 (Bat  (None, 64, 64, 256)          1024      ['conv2d_5[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_5 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_5[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_2 (MaxPoolin  (None, 32, 32, 256)          0         ['activation_5[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_6 (Conv2D)           (None, 32, 32, 512)          1180160   ['max_pooling2d_2[0][0]']     
                                                                                                  
 batch_normalization_6 (Bat  (None, 32, 32, 512)          2048      ['conv2d_6[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_6 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_6[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_7 (Conv2D)           (None, 32, 32, 512)          2359808   ['activation_6[0][0]']        
                                                                                                  
 batch_normalization_7 (Bat  (None, 32, 32, 512)          2048      ['conv2d_7[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_7 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_7[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_3 (MaxPoolin  (None, 16, 16, 512)          0         ['activation_7[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_8 (Conv2D)           (None, 16, 16, 1024)         4719616   ['max_pooling2d_3[0][0]']     
                                                                                                  
 batch_normalization_8 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_8[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_8 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_8[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_9 (Conv2D)           (None, 16, 16, 1024)         9438208   ['activation_8[0][0]']        
                                                                                                  
 batch_normalization_9 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_9[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_9 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_9[0][0]'
                                                                    ]                             
                                                                                                  
 up_sampling2d (UpSampling2  (None, 32, 32, 1024)         0         ['activation_9[0][0]']        
 D)                                                                                               
                                                                                                  
 concatenate (Concatenate)   (None, 32, 32, 1536)         0         ['up_sampling2d[0][0]',       
                                                                     'activation_7[0][0]']        
                                                                                                  
 conv2d_10 (Conv2D)          (None, 32, 32, 512)          7078400   ['concatenate[0][0]']         
                                                                                                  
 batch_normalization_10 (Ba  (None, 32, 32, 512)          2048      ['conv2d_10[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_10 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_10[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_11 (Conv2D)          (None, 32, 32, 512)          2359808   ['activation_10[0][0]']       
                                                                                                  
 batch_normalization_11 (Ba  (None, 32, 32, 512)          2048      ['conv2d_11[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_11 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_11[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_1 (UpSamplin  (None, 64, 64, 512)          0         ['activation_11[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_1 (Concatenate  (None, 64, 64, 768)          0         ['up_sampling2d_1[0][0]',     
 )                                                                   'activation_5[0][0]']        
                                                                                                  
 conv2d_12 (Conv2D)          (None, 64, 64, 256)          1769728   ['concatenate_1[0][0]']       
                                                                                                  
 batch_normalization_12 (Ba  (None, 64, 64, 256)          1024      ['conv2d_12[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_12 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_12[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_13 (Conv2D)          (None, 64, 64, 256)          590080    ['activation_12[0][0]']       
                                                                                                  
 batch_normalization_13 (Ba  (None, 64, 64, 256)          1024      ['conv2d_13[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_13 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_13[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_2 (UpSamplin  (None, 128, 128, 256)        0         ['activation_13[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_2 (Concatenate  (None, 128, 128, 384)        0         ['up_sampling2d_2[0][0]',     
 )                                                                   'activation_3[0][0]']        
                                                                                                  
 conv2d_14 (Conv2D)          (None, 128, 128, 128)        442496    ['concatenate_2[0][0]']       
                                                                                                  
 batch_normalization_14 (Ba  (None, 128, 128, 128)        512       ['conv2d_14[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_14 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_14[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_15 (Conv2D)          (None, 128, 128, 128)        147584    ['activation_14[0][0]']       
                                                                                                  
 batch_normalization_15 (Ba  (None, 128, 128, 128)        512       ['conv2d_15[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_15 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_15[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_3 (UpSamplin  (None, 256, 256, 128)        0         ['activation_15[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_3 (Concatenate  (None, 256, 256, 192)        0         ['up_sampling2d_3[0][0]',     
 )                                                                   'activation_1[0][0]']        
                                                                                                  
 conv2d_16 (Conv2D)          (None, 256, 256, 64)         110656    ['concatenate_3[0][0]']       
                                                                                                  
 batch_normalization_16 (Ba  (None, 256, 256, 64)         256       ['conv2d_16[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_16 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_16[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_17 (Conv2D)          (None, 256, 256, 64)         36928     ['activation_16[0][0]']       
                                                                                                  
 batch_normalization_17 (Ba  (None, 256, 256, 64)         256       ['conv2d_17[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_17 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_17[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_18 (Conv2D)          (None, 256, 256, 1)          65        ['activation_17[0][0]']       
                                                                                                  
 batch_normalization_18 (Ba  (None, 256, 256, 1)          4         ['conv2d_18[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_18 (Activation)  (None, 256, 256, 1)          0         ['batch_normalization_18[0][0]
                                                                    ']                            
                                                                                                  
==================================================================================================
Total params: 31401349 (119.79 MB)
Trainable params: 31389571 (119.74 MB)
Non-trainable params: 11778 (46.01 KB)
__________________________________________________________________________________________________
WARNING:absl:`lr` is deprecated in TF-Keras optimizer, please use `learning_rate` or use the legacy optimizer, e.g.,tf.keras.optimizers.legacy.Adam.
None
✓ focal_loss imported successfully
Epoch 1/30
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1758864311.578211 3270087 service.cc:145] XLA service 0x1488ad9e3350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1758864311.578257 3270087 service.cc:153]   StreamExecutor device (0): NVIDIA A40, Compute Capability 8.6
I0000 00:00:1758864312.036347 3270087 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
1/9 [==>...........................] - ETA: 7:59 - loss: 0.3408 - accuracy: 0.4905 - jacard_coef: 0.08562/9 [=====>........................] - ETA: 59s - loss: 0.3139 - accuracy: 0.4127 - jacard_coef: 0.0843 3/9 [=========>....................] - ETA: 26s - loss: 0.2916 - accuracy: 0.3490 - jacard_coef: 0.08204/9 [============>.................] - ETA: 15s - loss: 0.2724 - accuracy: 0.3081 - jacard_coef: 0.08275/9 [===============>..............] - ETA: 9s - loss: 0.2585 - accuracy: 0.3035 - jacard_coef: 0.0801 6/9 [===================>..........] - ETA: 5s - loss: 0.2525 - accuracy: 0.2748 - jacard_coef: 0.07497/9 [======================>.......] - ETA: 3s - loss: 0.2461 - accuracy: 0.2533 - jacard_coef: 0.07668/9 [=========================>....] - ETA: 1s - loss: 0.2400 - accuracy: 0.2355 - jacard_coef: 0.07699/9 [==============================] - ETA: 0s - loss: 0.2396 - accuracy: 0.2345 - jacard_coef: 0.07269/9 [==============================] - 79s 2s/step - loss: 0.2396 - accuracy: 0.2345 - jacard_coef: 0.0726 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4615e-05 - lr: 0.0010
Epoch 2/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1964 - accuracy: 0.0713 - jacard_coef: 0.05002/9 [=====>........................] - ETA: 2s - loss: 0.1960 - accuracy: 0.1171 - jacard_coef: 0.06513/9 [=========>....................] - ETA: 2s - loss: 0.1925 - accuracy: 0.1427 - jacard_coef: 0.07214/9 [============>.................] - ETA: 1s - loss: 0.1897 - accuracy: 0.1650 - jacard_coef: 0.07835/9 [===============>..............] - ETA: 1s - loss: 0.1894 - accuracy: 0.1869 - jacard_coef: 0.07616/9 [===================>..........] - ETA: 1s - loss: 0.1947 - accuracy: 0.2124 - jacard_coef: 0.07737/9 [======================>.......] - ETA: 0s - loss: 0.1939 - accuracy: 0.2357 - jacard_coef: 0.07808/9 [=========================>....] - ETA: 0s - loss: 0.1931 - accuracy: 0.2459 - jacard_coef: 0.07639/9 [==============================] - 3s 330ms/step - loss: 0.1932 - accuracy: 0.2460 - jacard_coef: 0.0751 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4615e-05 - lr: 0.0010
Epoch 3/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1889 - accuracy: 0.2407 - jacard_coef: 0.08442/9 [=====>........................] - ETA: 2s - loss: 0.1884 - accuracy: 0.2248 - jacard_coef: 0.09513/9 [=========>....................] - ETA: 2s - loss: 0.1975 - accuracy: 0.2028 - jacard_coef: 0.08184/9 [============>.................] - ETA: 1s - loss: 0.1943 - accuracy: 0.1982 - jacard_coef: 0.08095/9 [===============>..............] - ETA: 1s - loss: 0.1924 - accuracy: 0.1933 - jacard_coef: 0.07876/9 [===================>..........] - ETA: 1s - loss: 0.1909 - accuracy: 0.1903 - jacard_coef: 0.07757/9 [======================>.......] - ETA: 0s - loss: 0.1906 - accuracy: 0.1921 - jacard_coef: 0.07748/9 [=========================>....] - ETA: 0s - loss: 0.1907 - accuracy: 0.1916 - jacard_coef: 0.07559/9 [==============================] - 3s 330ms/step - loss: 0.1907 - accuracy: 0.1926 - jacard_coef: 0.0847 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4615e-05 - lr: 0.0010
Epoch 4/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1850 - accuracy: 0.2281 - jacard_coef: 0.04582/9 [=====>........................] - ETA: 2s - loss: 0.1942 - accuracy: 0.2607 - jacard_coef: 0.06463/9 [=========>....................] - ETA: 2s - loss: 0.1936 - accuracy: 0.2385 - jacard_coef: 0.06624/9 [============>.................] - ETA: 1s - loss: 0.1906 - accuracy: 0.2537 - jacard_coef: 0.06965/9 [===============>..............] - ETA: 1s - loss: 0.1892 - accuracy: 0.2549 - jacard_coef: 0.07536/9 [===================>..........] - ETA: 1s - loss: 0.1884 - accuracy: 0.2616 - jacard_coef: 0.07717/9 [======================>.......] - ETA: 0s - loss: 0.1877 - accuracy: 0.2725 - jacard_coef: 0.07668/9 [=========================>....] - ETA: 0s - loss: 0.1867 - accuracy: 0.2844 - jacard_coef: 0.07559/9 [==============================] - 3s 332ms/step - loss: 0.1866 - accuracy: 0.2856 - jacard_coef: 0.0838 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4615e-05 - lr: 0.0010
Epoch 5/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1840 - accuracy: 0.3012 - jacard_coef: 0.08862/9 [=====>........................] - ETA: 2s - loss: 0.1823 - accuracy: 0.3033 - jacard_coef: 0.06573/9 [=========>....................] - ETA: 2s - loss: 0.1801 - accuracy: 0.3117 - jacard_coef: 0.07114/9 [============>.................] - ETA: 1s - loss: 0.1786 - accuracy: 0.3242 - jacard_coef: 0.07985/9 [===============>..............] - ETA: 1s - loss: 0.1782 - accuracy: 0.3129 - jacard_coef: 0.07936/9 [===================>..........] - ETA: 1s - loss: 0.1774 - accuracy: 0.3477 - jacard_coef: 0.07807/9 [======================>.......] - ETA: 0s - loss: 0.1779 - accuracy: 0.3729 - jacard_coef: 0.07928/9 [=========================>....] - ETA: 0s - loss: 0.1778 - accuracy: 0.3844 - jacard_coef: 0.07669/9 [==============================] - 3s 340ms/step - loss: 0.1778 - accuracy: 0.3842 - jacard_coef: 0.0684 - val_loss: 1.1051 - val_accuracy: 0.9304 - val_jacard_coef: 6.9341e-04 - lr: 0.0010
Epoch 6/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1784 - accuracy: 0.6141 - jacard_coef: 0.05652/9 [=====>........................] - ETA: 2s - loss: 0.1773 - accuracy: 0.5848 - jacard_coef: 0.06953/9 [=========>....................] - ETA: 2s - loss: 0.1790 - accuracy: 0.5654 - jacard_coef: 0.07644/9 [============>.................] - ETA: 1s - loss: 0.1774 - accuracy: 0.5187 - jacard_coef: 0.07305/9 [===============>..............] - ETA: 1s - loss: 0.1764 - accuracy: 0.4935 - jacard_coef: 0.07766/9 [===================>..........] - ETA: 1s - loss: 0.1756 - accuracy: 0.4774 - jacard_coef: 0.07867/9 [======================>.......] - ETA: 0s - loss: 0.1749 - accuracy: 0.4794 - jacard_coef: 0.07738/9 [=========================>....] - ETA: 0s - loss: 0.1741 - accuracy: 0.5261 - jacard_coef: 0.07549/9 [==============================] - 3s 339ms/step - loss: 0.1741 - accuracy: 0.5250 - jacard_coef: 0.0812 - val_loss: 1.0160 - val_accuracy: 0.9298 - val_jacard_coef: 0.0019 - lr: 0.0010
Epoch 7/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1747 - accuracy: 0.6836 - jacard_coef: 0.04972/9 [=====>........................] - ETA: 2s - loss: 0.1706 - accuracy: 0.7726 - jacard_coef: 0.06093/9 [=========>....................] - ETA: 2s - loss: 0.1689 - accuracy: 0.8042 - jacard_coef: 0.06354/9 [============>.................] - ETA: 1s - loss: 0.1695 - accuracy: 0.7451 - jacard_coef: 0.06925/9 [===============>..............] - ETA: 1s - loss: 0.1692 - accuracy: 0.7151 - jacard_coef: 0.07526/9 [===================>..........] - ETA: 1s - loss: 0.1724 - accuracy: 0.6445 - jacard_coef: 0.07677/9 [======================>.......] - ETA: 0s - loss: 0.1723 - accuracy: 0.6782 - jacard_coef: 0.07758/9 [=========================>....] - ETA: 0s - loss: 0.1725 - accuracy: 0.6735 - jacard_coef: 0.07549/9 [==============================] - 3s 357ms/step - loss: 0.1726 - accuracy: 0.6715 - jacard_coef: 0.0807 - val_loss: 1.0668 - val_accuracy: 0.9272 - val_jacard_coef: 0.0109 - lr: 0.0010
Epoch 8/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1766 - accuracy: 0.5010 - jacard_coef: 0.07682/9 [=====>........................] - ETA: 2s - loss: 0.1769 - accuracy: 0.4334 - jacard_coef: 0.07343/9 [=========>....................] - ETA: 2s - loss: 0.1798 - accuracy: 0.4018 - jacard_coef: 0.07514/9 [============>.................] - ETA: 1s - loss: 0.1792 - accuracy: 0.3839 - jacard_coef: 0.07535/9 [===============>..............] - ETA: 1s - loss: 0.1776 - accuracy: 0.4023 - jacard_coef: 0.07576/9 [===================>..........] - ETA: 1s - loss: 0.1771 - accuracy: 0.4057 - jacard_coef: 0.07477/9 [======================>.......] - ETA: 0s - loss: 0.1760 - accuracy: 0.4249 - jacard_coef: 0.07878/9 [=========================>....] - ETA: 0s - loss: 0.1773 - accuracy: 0.4302 - jacard_coef: 0.07679/9 [==============================] - 3s 338ms/step - loss: 0.1775 - accuracy: 0.4292 - jacard_coef: 0.0685 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4615e-05 - lr: 0.0010
Epoch 9/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1727 - accuracy: 0.5837 - jacard_coef: 0.07702/9 [=====>........................] - ETA: 2s - loss: 0.1729 - accuracy: 0.5559 - jacard_coef: 0.07173/9 [=========>....................] - ETA: 2s - loss: 0.1778 - accuracy: 0.5500 - jacard_coef: 0.07764/9 [============>.................] - ETA: 1s - loss: 0.1806 - accuracy: 0.5172 - jacard_coef: 0.07665/9 [===============>..............] - ETA: 1s - loss: 0.1784 - accuracy: 0.5308 - jacard_coef: 0.07576/9 [===================>..........] - ETA: 1s - loss: 0.1785 - accuracy: 0.5134 - jacard_coef: 0.07657/9 [======================>.......] - ETA: 0s - loss: 0.1772 - accuracy: 0.5317 - jacard_coef: 0.07338/9 [=========================>....] - ETA: 0s - loss: 0.1773 - accuracy: 0.4990 - jacard_coef: 0.07619/9 [==============================] - 3s 338ms/step - loss: 0.1779 - accuracy: 0.4961 - jacard_coef: 0.0728 - val_loss: 1.1218 - val_accuracy: 0.9304 - val_jacard_coef: 1.4611e-05 - lr: 0.0010
Epoch 10/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1696 - accuracy: 0.7314 - jacard_coef: 0.07312/9 [=====>........................] - ETA: 2s - loss: 0.1686 - accuracy: 0.7400 - jacard_coef: 0.07313/9 [=========>....................] - ETA: 2s - loss: 0.1687 - accuracy: 0.7262 - jacard_coef: 0.07454/9 [============>.................] - ETA: 1s - loss: 0.1681 - accuracy: 0.7157 - jacard_coef: 0.07485/9 [===============>..............] - ETA: 1s - loss: 0.1685 - accuracy: 0.7083 - jacard_coef: 0.07626/9 [===================>..........] - ETA: 1s - loss: 0.1706 - accuracy: 0.7033 - jacard_coef: 0.07587/9 [======================>.......] - ETA: 0s - loss: 0.1699 - accuracy: 0.6982 - jacard_coef: 0.07408/9 [=========================>....] - ETA: 0s - loss: 0.1694 - accuracy: 0.6918 - jacard_coef: 0.07589/9 [==============================] - 3s 338ms/step - loss: 0.1694 - accuracy: 0.6908 - jacard_coef: 0.0808 - val_loss: 1.1148 - val_accuracy: 0.9302 - val_jacard_coef: 6.0264e-04 - lr: 0.0010
Epoch 11/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1714 - accuracy: 0.3589 - jacard_coef: 0.08052/9 [=====>........................] - ETA: 2s - loss: 0.1666 - accuracy: 0.6242 - jacard_coef: 0.07373/9 [=========>....................] - ETA: 2s - loss: 0.1693 - accuracy: 0.6957 - jacard_coef: 0.07264/9 [============>.................] - ETA: 1s - loss: 0.1677 - accuracy: 0.7243 - jacard_coef: 0.07865/9 [===============>..............] - ETA: 1s - loss: 0.1672 - accuracy: 0.7290 - jacard_coef: 0.07336/9 [===================>..........] - ETA: 1s - loss: 0.1666 - accuracy: 0.7560 - jacard_coef: 0.07327/9 [======================>.......] - ETA: 0s - loss: 0.1662 - accuracy: 0.7765 - jacard_coef: 0.07368/9 [=========================>....] - ETA: 0s - loss: 0.1652 - accuracy: 0.7925 - jacard_coef: 0.07519/9 [==============================] - 3s 358ms/step - loss: 0.1653 - accuracy: 0.7906 - jacard_coef: 0.0814 - val_loss: 0.2491 - val_accuracy: 0.8770 - val_jacard_coef: 0.0579 - lr: 0.0010
Epoch 12/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1617 - accuracy: 0.9087 - jacard_coef: 0.07722/9 [=====>........................] - ETA: 2s - loss: 0.1611 - accuracy: 0.9086 - jacard_coef: 0.07263/9 [=========>....................] - ETA: 2s - loss: 0.1636 - accuracy: 0.8999 - jacard_coef: 0.08054/9 [============>.................] - ETA: 1s - loss: 0.1632 - accuracy: 0.8986 - jacard_coef: 0.08135/9 [===============>..............] - ETA: 1s - loss: 0.1623 - accuracy: 0.8876 - jacard_coef: 0.07746/9 [===================>..........] - ETA: 1s - loss: 0.1616 - accuracy: 0.8921 - jacard_coef: 0.07647/9 [======================>.......] - ETA: 0s - loss: 0.1610 - accuracy: 0.8928 - jacard_coef: 0.07848/9 [=========================>....] - ETA: 0s - loss: 0.1602 - accuracy: 0.8982 - jacard_coef: 0.07559/9 [==============================] - 3s 339ms/step - loss: 0.1602 - accuracy: 0.8968 - jacard_coef: 0.0790 - val_loss: 0.4190 - val_accuracy: 0.9158 - val_jacard_coef: 0.0278 - lr: 0.0010
Epoch 13/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1542 - accuracy: 0.9061 - jacard_coef: 0.07792/9 [=====>........................] - ETA: 2s - loss: 0.1575 - accuracy: 0.9061 - jacard_coef: 0.07763/9 [=========>....................] - ETA: 2s - loss: 0.1563 - accuracy: 0.9114 - jacard_coef: 0.07224/9 [============>.................] - ETA: 1s - loss: 0.1559 - accuracy: 0.9064 - jacard_coef: 0.07535/9 [===============>..............] - ETA: 1s - loss: 0.1556 - accuracy: 0.9070 - jacard_coef: 0.07396/9 [===================>..........] - ETA: 1s - loss: 0.1551 - accuracy: 0.9059 - jacard_coef: 0.07387/9 [======================>.......] - ETA: 0s - loss: 0.1556 - accuracy: 0.8586 - jacard_coef: 0.07728/9 [=========================>....] - ETA: 0s - loss: 0.1554 - accuracy: 0.8664 - jacard_coef: 0.07529/9 [==============================] - 3s 339ms/step - loss: 0.1555 - accuracy: 0.8645 - jacard_coef: 0.0836 - val_loss: 0.2501 - val_accuracy: 0.8857 - val_jacard_coef: 0.0567 - lr: 0.0010
Epoch 14/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1556 - accuracy: 0.9026 - jacard_coef: 0.08392/9 [=====>........................] - ETA: 2s - loss: 0.1555 - accuracy: 0.9113 - jacard_coef: 0.07723/9 [=========>....................] - ETA: 2s - loss: 0.1545 - accuracy: 0.9090 - jacard_coef: 0.07844/9 [============>.................] - ETA: 1s - loss: 0.1545 - accuracy: 0.8979 - jacard_coef: 0.08035/9 [===============>..............] - ETA: 1s - loss: 0.1542 - accuracy: 0.8916 - jacard_coef: 0.08126/9 [===================>..........] - ETA: 1s - loss: 0.1537 - accuracy: 0.8899 - jacard_coef: 0.07857/9 [======================>.......] - ETA: 0s - loss: 0.1545 - accuracy: 0.8864 - jacard_coef: 0.07608/9 [=========================>....] - ETA: 0s - loss: 0.1542 - accuracy: 0.8807 - jacard_coef: 0.07609/9 [==============================] - 3s 359ms/step - loss: 0.1547 - accuracy: 0.8793 - jacard_coef: 0.0727 - val_loss: 0.1976 - val_accuracy: 0.4108 - val_jacard_coef: 0.0664 - lr: 0.0010
Epoch 15/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1549 - accuracy: 0.8687 - jacard_coef: 0.04962/9 [=====>........................] - ETA: 2s - loss: 0.1550 - accuracy: 0.8689 - jacard_coef: 0.06123/9 [=========>....................] - ETA: 2s - loss: 0.1568 - accuracy: 0.8821 - jacard_coef: 0.06424/9 [============>.................] - ETA: 1s - loss: 0.1579 - accuracy: 0.8834 - jacard_coef: 0.07095/9 [===============>..............] - ETA: 1s - loss: 0.1566 - accuracy: 0.8893 - jacard_coef: 0.07186/9 [===================>..........] - ETA: 1s - loss: 0.1571 - accuracy: 0.8939 - jacard_coef: 0.07207/9 [======================>.......] - ETA: 0s - loss: 0.1567 - accuracy: 0.8981 - jacard_coef: 0.07178/9 [=========================>....] - ETA: 0s - loss: 0.1564 - accuracy: 0.8974 - jacard_coef: 0.07489/9 [==============================] - 3s 339ms/step - loss: 0.1564 - accuracy: 0.8956 - jacard_coef: 0.0829 - val_loss: 0.2123 - val_accuracy: 0.9091 - val_jacard_coef: 0.0655 - lr: 0.0010
Epoch 16/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1533 - accuracy: 0.9117 - jacard_coef: 0.07952/9 [=====>........................] - ETA: 2s - loss: 0.1540 - accuracy: 0.9238 - jacard_coef: 0.06753/9 [=========>....................] - ETA: 2s - loss: 0.1531 - accuracy: 0.9216 - jacard_coef: 0.06734/9 [============>.................] - ETA: 1s - loss: 0.1524 - accuracy: 0.9171 - jacard_coef: 0.07065/9 [===============>..............] - ETA: 1s - loss: 0.1527 - accuracy: 0.9199 - jacard_coef: 0.06846/9 [===================>..........] - ETA: 1s - loss: 0.1525 - accuracy: 0.9165 - jacard_coef: 0.07217/9 [======================>.......] - ETA: 0s - loss: 0.1521 - accuracy: 0.9134 - jacard_coef: 0.07538/9 [=========================>....] - ETA: 0s - loss: 0.1516 - accuracy: 0.9136 - jacard_coef: 0.07569/9 [==============================] - 3s 339ms/step - loss: 0.1516 - accuracy: 0.9136 - jacard_coef: 0.0715 - val_loss: 0.1670 - val_accuracy: 0.6185 - val_jacard_coef: 0.0637 - lr: 0.0010
Epoch 17/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1532 - accuracy: 0.9091 - jacard_coef: 0.07372/9 [=====>........................] - ETA: 2s - loss: 0.1523 - accuracy: 0.9085 - jacard_coef: 0.07463/9 [=========>....................] - ETA: 2s - loss: 0.1516 - accuracy: 0.9147 - jacard_coef: 0.06924/9 [============>.................] - ETA: 1s - loss: 0.1515 - accuracy: 0.9158 - jacard_coef: 0.06945/9 [===============>..............] - ETA: 1s - loss: 0.1508 - accuracy: 0.9138 - jacard_coef: 0.07236/9 [===================>..........] - ETA: 1s - loss: 0.1512 - accuracy: 0.9129 - jacard_coef: 0.07417/9 [======================>.......] - ETA: 0s - loss: 0.1508 - accuracy: 0.9128 - jacard_coef: 0.07498/9 [=========================>....] - ETA: 0s - loss: 0.1502 - accuracy: 0.9136 - jacard_coef: 0.07489/9 [==============================] - 3s 338ms/step - loss: 0.1503 - accuracy: 0.9111 - jacard_coef: 0.0822 - val_loss: 0.1630 - val_accuracy: 0.7032 - val_jacard_coef: 0.0639 - lr: 0.0010
Epoch 18/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1483 - accuracy: 0.8997 - jacard_coef: 0.09032/9 [=====>........................] - ETA: 2s - loss: 0.1481 - accuracy: 0.9040 - jacard_coef: 0.08643/9 [=========>....................] - ETA: 2s - loss: 0.1502 - accuracy: 0.9115 - jacard_coef: 0.07934/9 [============>.................] - ETA: 1s - loss: 0.1500 - accuracy: 0.9073 - jacard_coef: 0.08215/9 [===============>..............] - ETA: 1s - loss: 0.1495 - accuracy: 0.9078 - jacard_coef: 0.08106/9 [===================>..........] - ETA: 1s - loss: 0.1489 - accuracy: 0.9130 - jacard_coef: 0.07607/9 [======================>.......] - ETA: 0s - loss: 0.1487 - accuracy: 0.9131 - jacard_coef: 0.07558/9 [=========================>....] - ETA: 0s - loss: 0.1484 - accuracy: 0.9126 - jacard_coef: 0.07589/9 [==============================] - 3s 339ms/step - loss: 0.1484 - accuracy: 0.9131 - jacard_coef: 0.0681 - val_loss: 0.1493 - val_accuracy: 0.9242 - val_jacard_coef: 0.0626 - lr: 0.0010
Epoch 19/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1530 - accuracy: 0.9210 - jacard_coef: 0.07042/9 [=====>........................] - ETA: 2s - loss: 0.1496 - accuracy: 0.9168 - jacard_coef: 0.07393/9 [=========>....................] - ETA: 2s - loss: 0.1473 - accuracy: 0.9249 - jacard_coef: 0.06664/9 [============>.................] - ETA: 1s - loss: 0.1479 - accuracy: 0.9177 - jacard_coef: 0.07215/9 [===============>..............] - ETA: 1s - loss: 0.1476 - accuracy: 0.9151 - jacard_coef: 0.07426/9 [===================>..........] - ETA: 1s - loss: 0.1473 - accuracy: 0.9139 - jacard_coef: 0.07557/9 [======================>.......] - ETA: 0s - loss: 0.1467 - accuracy: 0.9138 - jacard_coef: 0.07588/9 [=========================>....] - ETA: 0s - loss: 0.1463 - accuracy: 0.9154 - jacard_coef: 0.07479/9 [==============================] - 3s 339ms/step - loss: 0.1464 - accuracy: 0.9146 - jacard_coef: 0.0837 - val_loss: 0.1574 - val_accuracy: 0.9304 - val_jacard_coef: 0.0649 - lr: 0.0010
Epoch 20/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1477 - accuracy: 0.8863 - jacard_coef: 0.09992/9 [=====>........................] - ETA: 2s - loss: 0.1440 - accuracy: 0.9146 - jacard_coef: 0.07673/9 [=========>....................] - ETA: 2s - loss: 0.1443 - accuracy: 0.9055 - jacard_coef: 0.08444/9 [============>.................] - ETA: 1s - loss: 0.1444 - accuracy: 0.9043 - jacard_coef: 0.08575/9 [===============>..............] - ETA: 1s - loss: 0.1449 - accuracy: 0.9119 - jacard_coef: 0.07936/9 [===================>..........] - ETA: 1s - loss: 0.1441 - accuracy: 0.9161 - jacard_coef: 0.07587/9 [======================>.......] - ETA: 0s - loss: 0.1439 - accuracy: 0.9161 - jacard_coef: 0.07588/9 [=========================>....] - ETA: 0s - loss: 0.1436 - accuracy: 0.9163 - jacard_coef: 0.07559/9 [==============================] - 3s 338ms/step - loss: 0.1436 - accuracy: 0.9169 - jacard_coef: 0.0678 - val_loss: 0.1571 - val_accuracy: 0.9304 - val_jacard_coef: 0.0647 - lr: 5.0000e-04
Epoch 21/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1481 - accuracy: 0.9021 - jacard_coef: 0.08732/9 [=====>........................] - ETA: 2s - loss: 0.1439 - accuracy: 0.9179 - jacard_coef: 0.07403/9 [=========>....................] - ETA: 2s - loss: 0.1429 - accuracy: 0.9236 - jacard_coef: 0.06774/9 [============>.................] - ETA: 1s - loss: 0.1431 - accuracy: 0.9186 - jacard_coef: 0.07235/9 [===============>..............] - ETA: 1s - loss: 0.1432 - accuracy: 0.9153 - jacard_coef: 0.07556/9 [===================>..........] - ETA: 1s - loss: 0.1428 - accuracy: 0.9155 - jacard_coef: 0.07567/9 [======================>.......] - ETA: 0s - loss: 0.1425 - accuracy: 0.9159 - jacard_coef: 0.07548/9 [=========================>....] - ETA: 0s - loss: 0.1423 - accuracy: 0.9160 - jacard_coef: 0.07569/9 [==============================] - 3s 339ms/step - loss: 0.1426 - accuracy: 0.9162 - jacard_coef: 0.0695 - val_loss: 0.1540 - val_accuracy: 0.9304 - val_jacard_coef: 0.0647 - lr: 5.0000e-04
Epoch 22/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1406 - accuracy: 0.9129 - jacard_coef: 0.07632/9 [=====>........................] - ETA: 2s - loss: 0.1412 - accuracy: 0.9134 - jacard_coef: 0.07623/9 [=========>....................] - ETA: 2s - loss: 0.1417 - accuracy: 0.9138 - jacard_coef: 0.07564/9 [============>.................] - ETA: 1s - loss: 0.1409 - accuracy: 0.9196 - jacard_coef: 0.07105/9 [===============>..............] - ETA: 1s - loss: 0.1410 - accuracy: 0.9186 - jacard_coef: 0.07226/9 [===================>..........] - ETA: 1s - loss: 0.1415 - accuracy: 0.9116 - jacard_coef: 0.07827/9 [======================>.......] - ETA: 0s - loss: 0.1412 - accuracy: 0.9133 - jacard_coef: 0.07718/9 [=========================>....] - ETA: 0s - loss: 0.1415 - accuracy: 0.9154 - jacard_coef: 0.07559/9 [==============================] - 3s 339ms/step - loss: 0.1416 - accuracy: 0.9153 - jacard_coef: 0.0676 - val_loss: 0.1534 - val_accuracy: 0.9304 - val_jacard_coef: 0.0647 - lr: 5.0000e-04
Epoch 23/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1414 - accuracy: 0.9131 - jacard_coef: 0.07892/9 [=====>........................] - ETA: 2s - loss: 0.1396 - accuracy: 0.9237 - jacard_coef: 0.07003/9 [=========>....................] - ETA: 2s - loss: 0.1407 - accuracy: 0.9262 - jacard_coef: 0.06774/9 [============>.................] - ETA: 1s - loss: 0.1400 - accuracy: 0.9272 - jacard_coef: 0.06675/9 [===============>..............] - ETA: 1s - loss: 0.1404 - accuracy: 0.9216 - jacard_coef: 0.07116/9 [===================>..........] - ETA: 1s - loss: 0.1410 - accuracy: 0.9161 - jacard_coef: 0.07317/9 [======================>.......] - ETA: 0s - loss: 0.1406 - accuracy: 0.9175 - jacard_coef: 0.07228/9 [=========================>....] - ETA: 0s - loss: 0.1407 - accuracy: 0.9144 - jacard_coef: 0.07519/9 [==============================] - 3s 339ms/step - loss: 0.1407 - accuracy: 0.9144 - jacard_coef: 0.0740 - val_loss: 0.1544 - val_accuracy: 0.9304 - val_jacard_coef: 0.0650 - lr: 5.0000e-04
Epoch 24/30
1/9 [==>...........................] - ETA: 2s - loss: 0.1394 - accuracy: 0.9182 - jacard_coef: 0.07482/9 [=====>........................] - ETA: 2s - loss: 0.1391 - accuracy: 0.9218 - jacard_coef: 0.07183/9 [=========>....................] - ETA: 2s - loss: 0.1386 - accuracy: 0.9241 - jacard_coef: 0.06994/9 [============>.................] - ETA: 1s - loss: 0.1387 - accuracy: 0.9230 - jacard_coef: 0.07075/9 [===============>..............] - ETA: 1s - loss: 0.1384 - accuracy: 0.9263 - jacard_coef: 0.06796/9 [===================>..........] - ETA: 1s - loss: 0.1382 - accuracy: 0.9263 - jacard_coef: 0.06797/9 [======================>.......] - ETA: 0s - loss: 0.1392 - accuracy: 0.9192 - jacard_coef: 0.07368/9 [=========================>....] - ETA: 0s - loss: 0.1392 - accuracy: 0.9171 - jacard_coef: 0.07529/9 [==============================] - 3s 339ms/step - loss: 0.1393 - accuracy: 0.9157 - jacard_coef: 0.0709 - val_loss: 0.1505 - val_accuracy: 0.9304 - val_jacard_coef: 0.0646 - lr: 5.0000e-04
/usr/local/lib/python3.10/dist-packages/tf_keras/src/engine/training.py:3098: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native TF-Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(

✓ Training completed successfully!
  Best Val Jaccard: 0.0664 (epoch 14)
  Final Val Loss: 0.1505
  Training Time: 0:02:31.171633
  Stability (std): 0.0176

Results saved to: hyperparameter_optimization_20250926_123742/exp_20_Attention_UNet_lr1e-3_bs16/Attention_UNet_lr0.001_bs16_results.json
