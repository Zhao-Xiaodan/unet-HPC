✓ GPU memory growth enabled for 1 GPUs
Loading dataset...
Loaded 144 images and 144 masks
Training set: (129, 256, 256, 3), Validation set: (15, 256, 256, 3)

============================================================
TRAINING: Attention_ResUNet
Learning Rate: 0.0005, Batch Size: 8, Epochs: 30
============================================================
Model: "UNet"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_1 (InputLayer)        [(None, 256, 256, 1)]        0         []                            
                                                                                                  
 conv2d (Conv2D)             (None, 256, 256, 64)         640       ['input_1[0][0]']             
                                                                                                  
 batch_normalization (Batch  (None, 256, 256, 64)         256       ['conv2d[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 activation (Activation)     (None, 256, 256, 64)         0         ['batch_normalization[0][0]'] 
                                                                                                  
 conv2d_1 (Conv2D)           (None, 256, 256, 64)         36928     ['activation[0][0]']          
                                                                                                  
 batch_normalization_1 (Bat  (None, 256, 256, 64)         256       ['conv2d_1[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_1 (Activation)   (None, 256, 256, 64)         0         ['batch_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d (MaxPooling2  (None, 128, 128, 64)         0         ['activation_1[0][0]']        
 D)                                                                                               
                                                                                                  
 conv2d_2 (Conv2D)           (None, 128, 128, 128)        73856     ['max_pooling2d[0][0]']       
                                                                                                  
 batch_normalization_2 (Bat  (None, 128, 128, 128)        512       ['conv2d_2[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_2 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_2[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_3 (Conv2D)           (None, 128, 128, 128)        147584    ['activation_2[0][0]']        
                                                                                                  
 batch_normalization_3 (Bat  (None, 128, 128, 128)        512       ['conv2d_3[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_3 (Activation)   (None, 128, 128, 128)        0         ['batch_normalization_3[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_1 (MaxPoolin  (None, 64, 64, 128)          0         ['activation_3[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)           (None, 64, 64, 256)          295168    ['max_pooling2d_1[0][0]']     
                                                                                                  
 batch_normalization_4 (Bat  (None, 64, 64, 256)          1024      ['conv2d_4[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_4 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_4[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_5 (Conv2D)           (None, 64, 64, 256)          590080    ['activation_4[0][0]']        
                                                                                                  
 batch_normalization_5 (Bat  (None, 64, 64, 256)          1024      ['conv2d_5[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_5 (Activation)   (None, 64, 64, 256)          0         ['batch_normalization_5[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_2 (MaxPoolin  (None, 32, 32, 256)          0         ['activation_5[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_6 (Conv2D)           (None, 32, 32, 512)          1180160   ['max_pooling2d_2[0][0]']     
                                                                                                  
 batch_normalization_6 (Bat  (None, 32, 32, 512)          2048      ['conv2d_6[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_6 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_6[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_7 (Conv2D)           (None, 32, 32, 512)          2359808   ['activation_6[0][0]']        
                                                                                                  
 batch_normalization_7 (Bat  (None, 32, 32, 512)          2048      ['conv2d_7[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_7 (Activation)   (None, 32, 32, 512)          0         ['batch_normalization_7[0][0]'
                                                                    ]                             
                                                                                                  
 max_pooling2d_3 (MaxPoolin  (None, 16, 16, 512)          0         ['activation_7[0][0]']        
 g2D)                                                                                             
                                                                                                  
 conv2d_8 (Conv2D)           (None, 16, 16, 1024)         4719616   ['max_pooling2d_3[0][0]']     
                                                                                                  
 batch_normalization_8 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_8[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_8 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_8[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_9 (Conv2D)           (None, 16, 16, 1024)         9438208   ['activation_8[0][0]']        
                                                                                                  
 batch_normalization_9 (Bat  (None, 16, 16, 1024)         4096      ['conv2d_9[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_9 (Activation)   (None, 16, 16, 1024)         0         ['batch_normalization_9[0][0]'
                                                                    ]                             
                                                                                                  
 up_sampling2d (UpSampling2  (None, 32, 32, 1024)         0         ['activation_9[0][0]']        
 D)                                                                                               
                                                                                                  
 concatenate (Concatenate)   (None, 32, 32, 1536)         0         ['up_sampling2d[0][0]',       
                                                                     'activation_7[0][0]']        
                                                                                                  
 conv2d_10 (Conv2D)          (None, 32, 32, 512)          7078400   ['concatenate[0][0]']         
                                                                                                  
 batch_normalization_10 (Ba  (None, 32, 32, 512)          2048      ['conv2d_10[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_10 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_10[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_11 (Conv2D)          (None, 32, 32, 512)          2359808   ['activation_10[0][0]']       
                                                                                                  
 batch_normalization_11 (Ba  (None, 32, 32, 512)          2048      ['conv2d_11[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_11 (Activation)  (None, 32, 32, 512)          0         ['batch_normalization_11[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_1 (UpSamplin  (None, 64, 64, 512)          0         ['activation_11[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_1 (Concatenate  (None, 64, 64, 768)          0         ['up_sampling2d_1[0][0]',     
 )                                                                   'activation_5[0][0]']        
                                                                                                  
 conv2d_12 (Conv2D)          (None, 64, 64, 256)          1769728   ['concatenate_1[0][0]']       
                                                                                                  
 batch_normalization_12 (Ba  (None, 64, 64, 256)          1024      ['conv2d_12[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_12 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_12[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_13 (Conv2D)          (None, 64, 64, 256)          590080    ['activation_12[0][0]']       
                                                                                                  
 batch_normalization_13 (Ba  (None, 64, 64, 256)          1024      ['conv2d_13[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_13 (Activation)  (None, 64, 64, 256)          0         ['batch_normalization_13[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_2 (UpSamplin  (None, 128, 128, 256)        0         ['activation_13[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_2 (Concatenate  (None, 128, 128, 384)        0         ['up_sampling2d_2[0][0]',     
 )                                                                   'activation_3[0][0]']        
                                                                                                  
 conv2d_14 (Conv2D)          (None, 128, 128, 128)        442496    ['concatenate_2[0][0]']       
                                                                                                  
 batch_normalization_14 (Ba  (None, 128, 128, 128)        512       ['conv2d_14[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_14 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_14[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_15 (Conv2D)          (None, 128, 128, 128)        147584    ['activation_14[0][0]']       
                                                                                                  
 batch_normalization_15 (Ba  (None, 128, 128, 128)        512       ['conv2d_15[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_15 (Activation)  (None, 128, 128, 128)        0         ['batch_normalization_15[0][0]
                                                                    ']                            
                                                                                                  
 up_sampling2d_3 (UpSamplin  (None, 256, 256, 128)        0         ['activation_15[0][0]']       
 g2D)                                                                                             
                                                                                                  
 concatenate_3 (Concatenate  (None, 256, 256, 192)        0         ['up_sampling2d_3[0][0]',     
 )                                                                   'activation_1[0][0]']        
                                                                                                  
 conv2d_16 (Conv2D)          (None, 256, 256, 64)         110656    ['concatenate_3[0][0]']       
                                                                                                  
 batch_normalization_16 (Ba  (None, 256, 256, 64)         256       ['conv2d_16[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_16 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_16[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_17 (Conv2D)          (None, 256, 256, 64)         36928     ['activation_16[0][0]']       
                                                                                                  
 batch_normalization_17 (Ba  (None, 256, 256, 64)         256       ['conv2d_17[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_17 (Activation)  (None, 256, 256, 64)         0         ['batch_normalization_17[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_18 (Conv2D)          (None, 256, 256, 1)          65        ['activation_17[0][0]']       
                                                                                                  
 batch_normalization_18 (Ba  (None, 256, 256, 1)          4         ['conv2d_18[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_18 (Activation)  (None, 256, 256, 1)          0         ['batch_normalization_18[0][0]
                                                                    ']                            
                                                                                                  
==================================================================================================
Total params: 31401349 (119.79 MB)
Trainable params: 31389571 (119.74 MB)
Non-trainable params: 11778 (46.01 KB)
__________________________________________________________________________________________________
WARNING:absl:`lr` is deprecated in TF-Keras optimizer, please use `learning_rate` or use the legacy optimizer, e.g.,tf.keras.optimizers.legacy.Adam.
None
✓ focal_loss imported successfully
Epoch 1/30
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1758865707.100642 3325976 service.cc:145] XLA service 0x1462616e22a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1758865707.100700 3325976 service.cc:153]   StreamExecutor device (0): NVIDIA A40, Compute Capability 8.6
I0000 00:00:1758865707.565321 3325976 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
 1/17 [>.............................] - ETA: 16:56 - loss: 0.3424 - accuracy: 0.5207 - jacard_coef: 0.0807 2/17 [==>...........................] - ETA: 1:10 - loss: 0.3152 - accuracy: 0.4925 - jacard_coef: 0.0861  3/17 [====>.........................] - ETA: 34s - loss: 0.2885 - accuracy: 0.4734 - jacard_coef: 0.0917  4/17 [======>.......................] - ETA: 22s - loss: 0.2690 - accuracy: 0.4894 - jacard_coef: 0.0821 5/17 [=======>......................] - ETA: 15s - loss: 0.2556 - accuracy: 0.5287 - jacard_coef: 0.0828 6/17 [=========>....................] - ETA: 12s - loss: 0.2455 - accuracy: 0.5534 - jacard_coef: 0.0812 7/17 [===========>..................] - ETA: 9s - loss: 0.2375 - accuracy: 0.5732 - jacard_coef: 0.0776  8/17 [=============>................] - ETA: 7s - loss: 0.2301 - accuracy: 0.5813 - jacard_coef: 0.0770 9/17 [==============>...............] - ETA: 6s - loss: 0.2386 - accuracy: 0.5795 - jacard_coef: 0.073010/17 [================>.............] - ETA: 4s - loss: 0.2380 - accuracy: 0.5775 - jacard_coef: 0.074911/17 [==================>...........] - ETA: 3s - loss: 0.2354 - accuracy: 0.5872 - jacard_coef: 0.076512/17 [====================>.........] - ETA: 3s - loss: 0.2319 - accuracy: 0.5976 - jacard_coef: 0.077813/17 [=====================>........] - ETA: 2s - loss: 0.2287 - accuracy: 0.6061 - jacard_coef: 0.076414/17 [=======================>......] - ETA: 1s - loss: 0.2255 - accuracy: 0.6095 - jacard_coef: 0.076715/17 [=========================>....] - ETA: 1s - loss: 0.2227 - accuracy: 0.6126 - jacard_coef: 0.077316/17 [===========================>..] - ETA: 0s - loss: 0.2202 - accuracy: 0.6150 - jacard_coef: 0.076417/17 [==============================] - ETA: 0s - loss: 0.2198 - accuracy: 0.6154 - jacard_coef: 0.074017/17 [==============================] - 79s 993ms/step - loss: 0.2198 - accuracy: 0.6154 - jacard_coef: 0.0740 - val_loss: 1.1794 - val_accuracy: 0.9257 - val_jacard_coef: 0.0031 - lr: 0.0010
Epoch 2/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1759 - accuracy: 0.7138 - jacard_coef: 0.0691 2/17 [==>...........................] - ETA: 3s - loss: 0.1757 - accuracy: 0.7256 - jacard_coef: 0.0806 3/17 [====>.........................] - ETA: 2s - loss: 0.1758 - accuracy: 0.7444 - jacard_coef: 0.0823 4/17 [======>.......................] - ETA: 2s - loss: 0.1747 - accuracy: 0.7336 - jacard_coef: 0.0868 5/17 [=======>......................] - ETA: 2s - loss: 0.1736 - accuracy: 0.7285 - jacard_coef: 0.0803 6/17 [=========>....................] - ETA: 2s - loss: 0.1732 - accuracy: 0.7073 - jacard_coef: 0.0773 7/17 [===========>..................] - ETA: 2s - loss: 0.1727 - accuracy: 0.7126 - jacard_coef: 0.0785 8/17 [=============>................] - ETA: 1s - loss: 0.1725 - accuracy: 0.7285 - jacard_coef: 0.0764 9/17 [==============>...............] - ETA: 1s - loss: 0.1728 - accuracy: 0.7356 - jacard_coef: 0.077510/17 [================>.............] - ETA: 1s - loss: 0.1729 - accuracy: 0.7426 - jacard_coef: 0.076711/17 [==================>...........] - ETA: 1s - loss: 0.1728 - accuracy: 0.7503 - jacard_coef: 0.073712/17 [====================>.........] - ETA: 1s - loss: 0.1730 - accuracy: 0.7572 - jacard_coef: 0.075713/17 [=====================>........] - ETA: 0s - loss: 0.1731 - accuracy: 0.7631 - jacard_coef: 0.075114/17 [=======================>......] - ETA: 0s - loss: 0.1729 - accuracy: 0.7659 - jacard_coef: 0.076215/17 [=========================>....] - ETA: 0s - loss: 0.1726 - accuracy: 0.7679 - jacard_coef: 0.075116/17 [===========================>..] - ETA: 0s - loss: 0.1724 - accuracy: 0.7667 - jacard_coef: 0.075217/17 [==============================] - 4s 212ms/step - loss: 0.1732 - accuracy: 0.7656 - jacard_coef: 0.0790 - val_loss: 12.9416 - val_accuracy: 0.1303 - val_jacard_coef: 0.0673 - lr: 0.0010
Epoch 3/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1736 - accuracy: 0.7914 - jacard_coef: 0.1130 2/17 [==>...........................] - ETA: 3s - loss: 0.1853 - accuracy: 0.7901 - jacard_coef: 0.0851 3/17 [====>.........................] - ETA: 2s - loss: 0.1809 - accuracy: 0.7859 - jacard_coef: 0.0821 4/17 [======>.......................] - ETA: 2s - loss: 0.1786 - accuracy: 0.7954 - jacard_coef: 0.0750 5/17 [=======>......................] - ETA: 2s - loss: 0.1772 - accuracy: 0.8001 - jacard_coef: 0.0747 6/17 [=========>....................] - ETA: 2s - loss: 0.1760 - accuracy: 0.8017 - jacard_coef: 0.0732 7/17 [===========>..................] - ETA: 2s - loss: 0.1755 - accuracy: 0.8041 - jacard_coef: 0.0710 8/17 [=============>................] - ETA: 1s - loss: 0.1752 - accuracy: 0.8026 - jacard_coef: 0.0721 9/17 [==============>...............] - ETA: 1s - loss: 0.1747 - accuracy: 0.8062 - jacard_coef: 0.070910/17 [================>.............] - ETA: 1s - loss: 0.1740 - accuracy: 0.8053 - jacard_coef: 0.072611/17 [==================>...........] - ETA: 1s - loss: 0.1736 - accuracy: 0.8100 - jacard_coef: 0.073312/17 [====================>.........] - ETA: 1s - loss: 0.1733 - accuracy: 0.8132 - jacard_coef: 0.074613/17 [=====================>........] - ETA: 0s - loss: 0.1727 - accuracy: 0.8142 - jacard_coef: 0.075114/17 [=======================>......] - ETA: 0s - loss: 0.1723 - accuracy: 0.8174 - jacard_coef: 0.075215/17 [=========================>....] - ETA: 0s - loss: 0.1719 - accuracy: 0.8178 - jacard_coef: 0.074616/17 [===========================>..] - ETA: 0s - loss: 0.1715 - accuracy: 0.8088 - jacard_coef: 0.075817/17 [==============================] - 4s 211ms/step - loss: 0.1715 - accuracy: 0.8086 - jacard_coef: 0.0743 - val_loss: 1.5093 - val_accuracy: 0.3537 - val_jacard_coef: 0.0705 - lr: 0.0010
Epoch 4/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1628 - accuracy: 0.7339 - jacard_coef: 0.0817 2/17 [==>...........................] - ETA: 3s - loss: 0.1630 - accuracy: 0.7816 - jacard_coef: 0.0827 3/17 [====>.........................] - ETA: 2s - loss: 0.1635 - accuracy: 0.8073 - jacard_coef: 0.0835 4/17 [======>.......................] - ETA: 2s - loss: 0.1630 - accuracy: 0.8177 - jacard_coef: 0.0770 5/17 [=======>......................] - ETA: 2s - loss: 0.1629 - accuracy: 0.8205 - jacard_coef: 0.0786 6/17 [=========>....................] - ETA: 2s - loss: 0.1627 - accuracy: 0.8140 - jacard_coef: 0.0820 7/17 [===========>..................] - ETA: 2s - loss: 0.1630 - accuracy: 0.8048 - jacard_coef: 0.0883 8/17 [=============>................] - ETA: 1s - loss: 0.1631 - accuracy: 0.8059 - jacard_coef: 0.0903 9/17 [==============>...............] - ETA: 1s - loss: 0.1627 - accuracy: 0.8081 - jacard_coef: 0.085110/17 [================>.............] - ETA: 1s - loss: 0.1625 - accuracy: 0.8155 - jacard_coef: 0.083711/17 [==================>...........] - ETA: 1s - loss: 0.1623 - accuracy: 0.8166 - jacard_coef: 0.086112/17 [====================>.........] - ETA: 1s - loss: 0.1621 - accuracy: 0.8195 - jacard_coef: 0.083913/17 [=====================>........] - ETA: 0s - loss: 0.1618 - accuracy: 0.8212 - jacard_coef: 0.080614/17 [=======================>......] - ETA: 0s - loss: 0.1616 - accuracy: 0.8199 - jacard_coef: 0.078515/17 [=========================>....] - ETA: 0s - loss: 0.1614 - accuracy: 0.8229 - jacard_coef: 0.077716/17 [===========================>..] - ETA: 0s - loss: 0.1611 - accuracy: 0.8264 - jacard_coef: 0.075917/17 [==============================] - 4s 209ms/step - loss: 0.1611 - accuracy: 0.8268 - jacard_coef: 0.0718 - val_loss: 1.2060 - val_accuracy: 0.2179 - val_jacard_coef: 0.0680 - lr: 0.0010
Epoch 5/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1605 - accuracy: 0.7913 - jacard_coef: 0.1086 2/17 [==>...........................] - ETA: 3s - loss: 0.1594 - accuracy: 0.8367 - jacard_coef: 0.0921 3/17 [====>.........................] - ETA: 2s - loss: 0.1586 - accuracy: 0.8634 - jacard_coef: 0.0859 4/17 [======>.......................] - ETA: 2s - loss: 0.1584 - accuracy: 0.8808 - jacard_coef: 0.0793 5/17 [=======>......................] - ETA: 2s - loss: 0.1580 - accuracy: 0.8926 - jacard_coef: 0.0745 6/17 [=========>....................] - ETA: 2s - loss: 0.1582 - accuracy: 0.8928 - jacard_coef: 0.0777 7/17 [===========>..................] - ETA: 2s - loss: 0.1582 - accuracy: 0.8914 - jacard_coef: 0.0811 8/17 [=============>................] - ETA: 1s - loss: 0.1580 - accuracy: 0.8927 - jacard_coef: 0.0821 9/17 [==============>...............] - ETA: 1s - loss: 0.1579 - accuracy: 0.8953 - jacard_coef: 0.081410/17 [================>.............] - ETA: 1s - loss: 0.1638 - accuracy: 0.8725 - jacard_coef: 0.078311/17 [==================>...........] - ETA: 1s - loss: 0.1663 - accuracy: 0.8733 - jacard_coef: 0.078212/17 [====================>.........] - ETA: 1s - loss: 0.1655 - accuracy: 0.8760 - jacard_coef: 0.077213/17 [=====================>........] - ETA: 0s - loss: 0.1650 - accuracy: 0.8778 - jacard_coef: 0.076514/17 [=======================>......] - ETA: 0s - loss: 0.1646 - accuracy: 0.8782 - jacard_coef: 0.076015/17 [=========================>....] - ETA: 0s - loss: 0.1642 - accuracy: 0.8807 - jacard_coef: 0.074316/17 [===========================>..] - ETA: 0s - loss: 0.1638 - accuracy: 0.8813 - jacard_coef: 0.074917/17 [==============================] - 4s 209ms/step - loss: 0.1639 - accuracy: 0.8809 - jacard_coef: 0.0781 - val_loss: 0.3427 - val_accuracy: 0.3435 - val_jacard_coef: 0.0686 - lr: 0.0010
Epoch 6/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1612 - accuracy: 0.8795 - jacard_coef: 0.0945 2/17 [==>...........................] - ETA: 3s - loss: 0.1599 - accuracy: 0.9131 - jacard_coef: 0.0692 3/17 [====>.........................] - ETA: 2s - loss: 0.1610 - accuracy: 0.8691 - jacard_coef: 0.0713 4/17 [======>.......................] - ETA: 2s - loss: 0.1605 - accuracy: 0.8779 - jacard_coef: 0.0719 5/17 [=======>......................] - ETA: 2s - loss: 0.1599 - accuracy: 0.8805 - jacard_coef: 0.0660 6/17 [=========>....................] - ETA: 2s - loss: 0.1594 - accuracy: 0.8902 - jacard_coef: 0.0642 7/17 [===========>..................] - ETA: 2s - loss: 0.1593 - accuracy: 0.8947 - jacard_coef: 0.0647 8/17 [=============>................] - ETA: 1s - loss: 0.1590 - accuracy: 0.8949 - jacard_coef: 0.0672 9/17 [==============>...............] - ETA: 1s - loss: 0.1594 - accuracy: 0.8940 - jacard_coef: 0.070010/17 [================>.............] - ETA: 1s - loss: 0.1592 - accuracy: 0.8947 - jacard_coef: 0.069511/17 [==================>...........] - ETA: 1s - loss: 0.1589 - accuracy: 0.8933 - jacard_coef: 0.069112/17 [====================>.........] - ETA: 1s - loss: 0.1583 - accuracy: 0.8946 - jacard_coef: 0.067813/17 [=====================>........] - ETA: 0s - loss: 0.1582 - accuracy: 0.8930 - jacard_coef: 0.068314/17 [=======================>......] - ETA: 0s - loss: 0.1584 - accuracy: 0.8891 - jacard_coef: 0.072315/17 [=========================>....] - ETA: 0s - loss: 0.1583 - accuracy: 0.8888 - jacard_coef: 0.073516/17 [===========================>..] - ETA: 0s - loss: 0.1583 - accuracy: 0.8881 - jacard_coef: 0.075617/17 [==============================] - ETA: 0s - loss: 0.1583 - accuracy: 0.8889 - jacard_coef: 0.071517/17 [==============================] - 4s 213ms/step - loss: 0.1583 - accuracy: 0.8889 - jacard_coef: 0.0715 - val_loss: 0.1486 - val_accuracy: 0.9217 - val_jacard_coef: 0.0628 - lr: 0.0010
Epoch 7/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1500 - accuracy: 0.9525 - jacard_coef: 0.0419 2/17 [==>...........................] - ETA: 3s - loss: 0.1528 - accuracy: 0.9156 - jacard_coef: 0.0670 3/17 [====>.........................] - ETA: 2s - loss: 0.1520 - accuracy: 0.9201 - jacard_coef: 0.0653 4/17 [======>.......................] - ETA: 2s - loss: 0.1519 - accuracy: 0.9250 - jacard_coef: 0.0626 5/17 [=======>......................] - ETA: 2s - loss: 0.1521 - accuracy: 0.9238 - jacard_coef: 0.0643 6/17 [=========>....................] - ETA: 2s - loss: 0.1522 - accuracy: 0.9153 - jacard_coef: 0.0690 7/17 [===========>..................] - ETA: 2s - loss: 0.1526 - accuracy: 0.9110 - jacard_coef: 0.0734 8/17 [=============>................] - ETA: 1s - loss: 0.1527 - accuracy: 0.9110 - jacard_coef: 0.0724 9/17 [==============>...............] - ETA: 1s - loss: 0.1524 - accuracy: 0.9090 - jacard_coef: 0.071810/17 [================>.............] - ETA: 1s - loss: 0.1521 - accuracy: 0.9057 - jacard_coef: 0.071211/17 [==================>...........] - ETA: 1s - loss: 0.1521 - accuracy: 0.9044 - jacard_coef: 0.072512/17 [====================>.........] - ETA: 1s - loss: 0.1519 - accuracy: 0.9039 - jacard_coef: 0.071013/17 [=====================>........] - ETA: 0s - loss: 0.1518 - accuracy: 0.9003 - jacard_coef: 0.074314/17 [=======================>......] - ETA: 0s - loss: 0.1518 - accuracy: 0.8997 - jacard_coef: 0.075615/17 [=========================>....] - ETA: 0s - loss: 0.1516 - accuracy: 0.9008 - jacard_coef: 0.075616/17 [===========================>..] - ETA: 0s - loss: 0.1516 - accuracy: 0.9016 - jacard_coef: 0.075717/17 [==============================] - ETA: 0s - loss: 0.1523 - accuracy: 0.8984 - jacard_coef: 0.071417/17 [==============================] - 4s 215ms/step - loss: 0.1523 - accuracy: 0.8984 - jacard_coef: 0.0714 - val_loss: 0.1429 - val_accuracy: 0.9188 - val_jacard_coef: 0.0627 - lr: 0.0010
Epoch 8/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1531 - accuracy: 0.8624 - jacard_coef: 0.0945 2/17 [==>...........................] - ETA: 3s - loss: 0.1553 - accuracy: 0.8293 - jacard_coef: 0.0979 3/17 [====>.........................] - ETA: 2s - loss: 0.1551 - accuracy: 0.8320 - jacard_coef: 0.0926 4/17 [======>.......................] - ETA: 2s - loss: 0.1542 - accuracy: 0.8367 - jacard_coef: 0.0827 5/17 [=======>......................] - ETA: 2s - loss: 0.1539 - accuracy: 0.8377 - jacard_coef: 0.0811 6/17 [=========>....................] - ETA: 2s - loss: 0.1535 - accuracy: 0.8435 - jacard_coef: 0.0797 7/17 [===========>..................] - ETA: 2s - loss: 0.1524 - accuracy: 0.8555 - jacard_coef: 0.0750 8/17 [=============>................] - ETA: 1s - loss: 0.1529 - accuracy: 0.8605 - jacard_coef: 0.0730 9/17 [==============>...............] - ETA: 1s - loss: 0.1530 - accuracy: 0.8615 - jacard_coef: 0.076210/17 [================>.............] - ETA: 1s - loss: 0.1528 - accuracy: 0.8641 - jacard_coef: 0.078411/17 [==================>...........] - ETA: 1s - loss: 0.1523 - accuracy: 0.8682 - jacard_coef: 0.077812/17 [====================>.........] - ETA: 1s - loss: 0.1519 - accuracy: 0.8717 - jacard_coef: 0.076913/17 [=====================>........] - ETA: 0s - loss: 0.1518 - accuracy: 0.8734 - jacard_coef: 0.078114/17 [=======================>......] - ETA: 0s - loss: 0.1513 - accuracy: 0.8805 - jacard_coef: 0.074215/17 [=========================>....] - ETA: 0s - loss: 0.1510 - accuracy: 0.8830 - jacard_coef: 0.074016/17 [===========================>..] - ETA: 0s - loss: 0.1509 - accuracy: 0.8834 - jacard_coef: 0.075217/17 [==============================] - ETA: 0s - loss: 0.1509 - accuracy: 0.8838 - jacard_coef: 0.074617/17 [==============================] - 4s 215ms/step - loss: 0.1509 - accuracy: 0.8838 - jacard_coef: 0.0746 - val_loss: 0.1860 - val_accuracy: 0.9252 - val_jacard_coef: 0.0481 - lr: 0.0010
Epoch 9/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1469 - accuracy: 0.8935 - jacard_coef: 0.0896 2/17 [==>...........................] - ETA: 3s - loss: 0.1466 - accuracy: 0.9071 - jacard_coef: 0.0808 3/17 [====>.........................] - ETA: 2s - loss: 0.1467 - accuracy: 0.9066 - jacard_coef: 0.0815 4/17 [======>.......................] - ETA: 2s - loss: 0.1458 - accuracy: 0.9194 - jacard_coef: 0.0708 5/17 [=======>......................] - ETA: 2s - loss: 0.1463 - accuracy: 0.9181 - jacard_coef: 0.0722 6/17 [=========>....................] - ETA: 2s - loss: 0.1456 - accuracy: 0.9214 - jacard_coef: 0.0696 7/17 [===========>..................] - ETA: 2s - loss: 0.1452 - accuracy: 0.9233 - jacard_coef: 0.0676 8/17 [=============>................] - ETA: 1s - loss: 0.1445 - accuracy: 0.9278 - jacard_coef: 0.0639 9/17 [==============>...............] - ETA: 1s - loss: 0.1447 - accuracy: 0.9252 - jacard_coef: 0.066310/17 [================>.............] - ETA: 1s - loss: 0.1447 - accuracy: 0.9227 - jacard_coef: 0.068211/17 [==================>...........] - ETA: 1s - loss: 0.1448 - accuracy: 0.9231 - jacard_coef: 0.067912/17 [====================>.........] - ETA: 1s - loss: 0.1451 - accuracy: 0.9197 - jacard_coef: 0.070813/17 [=====================>........] - ETA: 0s - loss: 0.1450 - accuracy: 0.9189 - jacard_coef: 0.071614/17 [=======================>......] - ETA: 0s - loss: 0.1449 - accuracy: 0.9183 - jacard_coef: 0.072215/17 [=========================>....] - ETA: 0s - loss: 0.1452 - accuracy: 0.9149 - jacard_coef: 0.075016/17 [===========================>..] - ETA: 0s - loss: 0.1453 - accuracy: 0.9146 - jacard_coef: 0.075417/17 [==============================] - ETA: 0s - loss: 0.1453 - accuracy: 0.9152 - jacard_coef: 0.071417/17 [==============================] - 4s 215ms/step - loss: 0.1453 - accuracy: 0.9152 - jacard_coef: 0.0714 - val_loss: 0.1359 - val_accuracy: 0.9266 - val_jacard_coef: 0.0579 - lr: 5.0000e-04
Epoch 10/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1448 - accuracy: 0.8934 - jacard_coef: 0.0930 2/17 [==>...........................] - ETA: 3s - loss: 0.1436 - accuracy: 0.9124 - jacard_coef: 0.0777 3/17 [====>.........................] - ETA: 2s - loss: 0.1442 - accuracy: 0.9081 - jacard_coef: 0.0818 4/17 [======>.......................] - ETA: 2s - loss: 0.1432 - accuracy: 0.9187 - jacard_coef: 0.0729 5/17 [=======>......................] - ETA: 2s - loss: 0.1430 - accuracy: 0.9218 - jacard_coef: 0.0705 6/17 [=========>....................] - ETA: 2s - loss: 0.1428 - accuracy: 0.9253 - jacard_coef: 0.0676 7/17 [===========>..................] - ETA: 2s - loss: 0.1426 - accuracy: 0.9265 - jacard_coef: 0.0667 8/17 [=============>................] - ETA: 1s - loss: 0.1430 - accuracy: 0.9205 - jacard_coef: 0.0716 9/17 [==============>...............] - ETA: 1s - loss: 0.1431 - accuracy: 0.9185 - jacard_coef: 0.073210/17 [================>.............] - ETA: 1s - loss: 0.1435 - accuracy: 0.9139 - jacard_coef: 0.077011/17 [==================>...........] - ETA: 1s - loss: 0.1433 - accuracy: 0.9165 - jacard_coef: 0.074912/17 [====================>.........] - ETA: 1s - loss: 0.1431 - accuracy: 0.9169 - jacard_coef: 0.074713/17 [=====================>........] - ETA: 0s - loss: 0.1430 - accuracy: 0.9185 - jacard_coef: 0.073314/17 [=======================>......] - ETA: 0s - loss: 0.1430 - accuracy: 0.9184 - jacard_coef: 0.073415/17 [=========================>....] - ETA: 0s - loss: 0.1431 - accuracy: 0.9166 - jacard_coef: 0.074716/17 [===========================>..] - ETA: 0s - loss: 0.1473 - accuracy: 0.8961 - jacard_coef: 0.074417/17 [==============================] - ETA: 0s - loss: 0.1477 - accuracy: 0.8944 - jacard_coef: 0.078517/17 [==============================] - 4s 215ms/step - loss: 0.1477 - accuracy: 0.8944 - jacard_coef: 0.0785 - val_loss: 0.1430 - val_accuracy: 0.9209 - val_jacard_coef: 0.0593 - lr: 5.0000e-04
Epoch 11/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1580 - accuracy: 0.9035 - jacard_coef: 0.0669 2/17 [==>...........................] - ETA: 3s - loss: 0.1670 - accuracy: 0.8821 - jacard_coef: 0.0881 3/17 [====>.........................] - ETA: 2s - loss: 0.1693 - accuracy: 0.8802 - jacard_coef: 0.0912 4/17 [======>.......................] - ETA: 2s - loss: 0.1675 - accuracy: 0.8862 - jacard_coef: 0.0879 5/17 [=======>......................] - ETA: 2s - loss: 0.1659 - accuracy: 0.8940 - jacard_coef: 0.0823 6/17 [=========>....................] - ETA: 2s - loss: 0.1649 - accuracy: 0.8955 - jacard_coef: 0.0815 7/17 [===========>..................] - ETA: 2s - loss: 0.1636 - accuracy: 0.8999 - jacard_coef: 0.0783 8/17 [=============>................] - ETA: 1s - loss: 0.1625 - accuracy: 0.9014 - jacard_coef: 0.0773 9/17 [==============>...............] - ETA: 1s - loss: 0.1618 - accuracy: 0.8996 - jacard_coef: 0.078810/17 [================>.............] - ETA: 1s - loss: 0.1611 - accuracy: 0.9021 - jacard_coef: 0.076911/17 [==================>...........] - ETA: 1s - loss: 0.1606 - accuracy: 0.9025 - jacard_coef: 0.076712/17 [====================>.........] - ETA: 1s - loss: 0.1594 - accuracy: 0.9074 - jacard_coef: 0.073013/17 [=====================>........] - ETA: 0s - loss: 0.1589 - accuracy: 0.9070 - jacard_coef: 0.073914/17 [=======================>......] - ETA: 0s - loss: 0.1583 - accuracy: 0.9080 - jacard_coef: 0.073615/17 [=========================>....] - ETA: 0s - loss: 0.1579 - accuracy: 0.9077 - jacard_coef: 0.074316/17 [===========================>..] - ETA: 0s - loss: 0.1575 - accuracy: 0.9081 - jacard_coef: 0.074417/17 [==============================] - ETA: 0s - loss: 0.1575 - accuracy: 0.9082 - jacard_coef: 0.073917/17 [==============================] - 4s 215ms/step - loss: 0.1575 - accuracy: 0.9082 - jacard_coef: 0.0739 - val_loss: 0.1192 - val_accuracy: 0.9303 - val_jacard_coef: 0.0622 - lr: 5.0000e-04
Epoch 12/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1471 - accuracy: 0.9215 - jacard_coef: 0.0695 2/17 [==>...........................] - ETA: 3s - loss: 0.1492 - accuracy: 0.9094 - jacard_coef: 0.0786 3/17 [====>.........................] - ETA: 2s - loss: 0.1487 - accuracy: 0.9099 - jacard_coef: 0.0783 4/17 [======>.......................] - ETA: 2s - loss: 0.1489 - accuracy: 0.9082 - jacard_coef: 0.0784 5/17 [=======>......................] - ETA: 2s - loss: 0.1500 - accuracy: 0.8971 - jacard_coef: 0.0851 6/17 [=========>....................] - ETA: 2s - loss: 0.1491 - accuracy: 0.8976 - jacard_coef: 0.0839 7/17 [===========>..................] - ETA: 2s - loss: 0.1489 - accuracy: 0.8964 - jacard_coef: 0.0840 8/17 [=============>................] - ETA: 1s - loss: 0.1485 - accuracy: 0.8973 - jacard_coef: 0.0835 9/17 [==============>...............] - ETA: 1s - loss: 0.1482 - accuracy: 0.8975 - jacard_coef: 0.083910/17 [================>.............] - ETA: 1s - loss: 0.1478 - accuracy: 0.8996 - jacard_coef: 0.082411/17 [==================>...........] - ETA: 1s - loss: 0.1471 - accuracy: 0.9046 - jacard_coef: 0.078312/17 [====================>.........] - ETA: 1s - loss: 0.1470 - accuracy: 0.9041 - jacard_coef: 0.078613/17 [=====================>........] - ETA: 0s - loss: 0.1466 - accuracy: 0.9069 - jacard_coef: 0.076314/17 [=======================>......] - ETA: 0s - loss: 0.1464 - accuracy: 0.9069 - jacard_coef: 0.076515/17 [=========================>....] - ETA: 0s - loss: 0.1461 - accuracy: 0.9070 - jacard_coef: 0.076416/17 [===========================>..] - ETA: 0s - loss: 0.1459 - accuracy: 0.9082 - jacard_coef: 0.075317/17 [==============================] - ETA: 0s - loss: 0.1459 - accuracy: 0.9087 - jacard_coef: 0.071217/17 [==============================] - 4s 215ms/step - loss: 0.1459 - accuracy: 0.9087 - jacard_coef: 0.0712 - val_loss: 0.1171 - val_accuracy: 0.9304 - val_jacard_coef: 0.0618 - lr: 5.0000e-04
Epoch 13/30
 1/17 [>.............................] - ETA: 3s - loss: 0.1415 - accuracy: 0.9122 - jacard_coef: 0.0750 2/17 [==>...........................] - ETA: 3s - loss: 0.1401 - accuracy: 0.9295 - jacard_coef: 0.0594 3/17 [====>.........................] - ETA: 2s - loss: 0.1420 - accuracy: 0.9184 - jacard_coef: 0.0687 4/17 [======>.......................] - ETA: 2s - loss: 0.1412 - accuracy: 0.9183 - jacard_coef: 0.0689 5/17 [=======>......................] - ETA: 2s - loss: 0.1414 - accuracy: 0.9150 - jacard_coef: 0.0717 6/17 [=========>....................] - ETA: 2s - loss: 0.1411 - accuracy: 0.9143 - jacard_coef: 0.0728 7/17 [===========>..................] - ETA: 2s - loss: 0.1409 - accuracy: 0.9144 - jacard_coef: 0.0726 8/17 [=============>................] - ETA: 1s - loss: 0.1411 - accuracy: 0.9123 - jacard_coef: 0.0731 9/17 [==============>...............] - ETA: 1s - loss: 0.1410 - accuracy: 0.9117 - jacard_coef: 0.072310/17 [================>.............] - ETA: 1s - loss: 0.1408 - accuracy: 0.9110 - jacard_coef: 0.072711/17 [==================>...........] - ETA: 1s - loss: 0.1408 - accuracy: 0.9097 - jacard_coef: 0.073412/17 [====================>.........] - ETA: 1s - loss: 0.1407 - accuracy: 0.9112 - jacard_coef: 0.072413/17 [=====================>........] - ETA: 0s - loss: 0.1409 - accuracy: 0.9092 - jacard_coef: 0.074414/17 [=======================>......] - ETA: 0s - loss: 0.1409 - accuracy: 0.9096 - jacard_coef: 0.074615/17 [=========================>....] - ETA: 0s - loss: 0.1411 - accuracy: 0.9085 - jacard_coef: 0.075816/17 [===========================>..] - ETA: 0s - loss: 0.1408 - accuracy: 0.9107 - jacard_coef: 0.074317/17 [==============================] - ETA: 0s - loss: 0.1409 - accuracy: 0.9097 - jacard_coef: 0.079317/17 [==============================] - 4s 215ms/step - loss: 0.1409 - accuracy: 0.9097 - jacard_coef: 0.0793 - val_loss: 0.1193 - val_accuracy: 0.9304 - val_jacard_coef: 0.0623 - lr: 5.0000e-04
/usr/local/lib/python3.10/dist-packages/tf_keras/src/engine/training.py:3098: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native TF-Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(

✓ Training completed successfully!
  Best Val Jaccard: 0.0705 (epoch 3)
  Final Val Loss: 0.1193
  Training Time: 0:02:04.089290
  Stability (std): 0.3197

Results saved to: hyperparameter_optimization_20250926_123742/exp_28_Attention_ResUNet_lr5e-4_bs8/Attention_ResUNet_lr0.0005_bs8_results.json
